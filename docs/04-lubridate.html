<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 lubridate处理时间数据 | 环境数据分析与可视化</title>
  <meta name="description" content="厦门大学环境与生态学院研究生课程" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 lubridate处理时间数据 | 环境数据分析与可视化" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="厦门大学环境与生态学院研究生课程" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 lubridate处理时间数据 | 环境数据分析与可视化" />
  
  <meta name="twitter:description" content="厦门大学环境与生态学院研究生课程" />
  

<meta name="author" content="谭巧国" />


<meta name="date" content="2022-06-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="03-dplyr.html"/>
<link rel="next" href="05-map.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.23/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="1" data-path="01-intro.html"><a href="01-intro.html"><i class="fa fa-check"></i><b>1</b> R的基础知识</a>
<ul>
<li class="chapter" data-level="1.1" data-path="01-intro.html"><a href="01-intro.html#科学计算器"><i class="fa fa-check"></i><b>1.1</b> 科学计算器</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="01-intro.html"><a href="01-intro.html#取整"><i class="fa fa-check"></i><b>1.1.1</b> 取整</a></li>
<li class="chapter" data-level="1.1.2" data-path="01-intro.html"><a href="01-intro.html#保留有效数字"><i class="fa fa-check"></i><b>1.1.2</b> 保留有效数字</a></li>
<li class="chapter" data-level="1.1.3" data-path="01-intro.html"><a href="01-intro.html#常用运算符"><i class="fa fa-check"></i><b>1.1.3</b> 常用运算符</a></li>
<li class="chapter" data-level="1.1.4" data-path="01-intro.html"><a href="01-intro.html#逻辑运算"><i class="fa fa-check"></i><b>1.1.4</b> 逻辑运算</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="01-intro.html"><a href="01-intro.html#变量赋值"><i class="fa fa-check"></i><b>1.2</b> 变量赋值</a></li>
<li class="chapter" data-level="1.3" data-path="01-intro.html"><a href="01-intro.html#变量取名规则"><i class="fa fa-check"></i><b>1.3</b> 变量取名规则</a></li>
<li class="chapter" data-level="1.4" data-path="01-intro.html"><a href="01-intro.html#变量类型"><i class="fa fa-check"></i><b>1.4</b> 变量类型</a></li>
<li class="chapter" data-level="1.5" data-path="01-intro.html"><a href="01-intro.html#常用的数据类型"><i class="fa fa-check"></i><b>1.5</b> 常用的数据类型</a></li>
<li class="chapter" data-level="1.6" data-path="01-intro.html"><a href="01-intro.html#数据类型强制转化coercing"><i class="fa fa-check"></i><b>1.6</b> 数据类型强制转化（<code>coercing</code>）</a></li>
<li class="chapter" data-level="1.7" data-path="01-intro.html"><a href="01-intro.html#缺失值na和无穷大inf"><i class="fa fa-check"></i><b>1.7</b> 缺失值（<code>NA</code>）和无穷大（<code>Inf</code>）</a></li>
<li class="chapter" data-level="1.8" data-path="01-intro.html"><a href="01-intro.html#向量vector"><i class="fa fa-check"></i><b>1.8</b> 向量（vector）</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="01-intro.html"><a href="01-intro.html#用函数c-生成向量"><i class="fa fa-check"></i><b>1.8.1</b> 用函数<code>c( )</code>生成向量</a></li>
<li class="chapter" data-level="1.8.2" data-path="01-intro.html"><a href="01-intro.html#用-seq生成等差序列"><i class="fa fa-check"></i><b>1.8.2</b> 用 <code>seq()</code>生成等差序列</a></li>
<li class="chapter" data-level="1.8.3" data-path="01-intro.html"><a href="01-intro.html#用符号生成连续自然数序列"><i class="fa fa-check"></i><b>1.8.3</b> 用<code>:</code>符号生成连续自然数序列</a></li>
<li class="chapter" data-level="1.8.4" data-path="01-intro.html"><a href="01-intro.html#用rep重复元素生成向量"><i class="fa fa-check"></i><b>1.8.4</b> 用<strong><code>rep()</code></strong>重复元素，生成向量</a></li>
<li class="chapter" data-level="1.8.5" data-path="01-intro.html"><a href="01-intro.html#向量信息提取与运算"><i class="fa fa-check"></i><b>1.8.5</b> 向量信息提取与运算</a></li>
<li class="chapter" data-level="1.8.6" data-path="01-intro.html"><a href="01-intro.html#针对向量的统计运算"><i class="fa fa-check"></i><b>1.8.6</b> 针对向量的统计运算</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="01-intro.html"><a href="01-intro.html#矩阵matrix"><i class="fa fa-check"></i><b>1.9</b> 矩阵（matrix）</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="01-intro.html"><a href="01-intro.html#用matrix函数生成一个矩阵"><i class="fa fa-check"></i><b>1.9.1</b> 用<code>matrix()</code>函数生成一个矩阵</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="01-intro.html"><a href="01-intro.html#数据表data-frame"><i class="fa fa-check"></i><b>1.10</b> 数据表（data frame）</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="01-intro.html"><a href="01-intro.html#用data.frame函数生成一个数据表"><i class="fa fa-check"></i><b>1.10.1</b> 用<code>data.frame()</code>函数生成一个数据表</a></li>
<li class="chapter" data-level="1.10.2" data-path="01-intro.html"><a href="01-intro.html#引用data.frame中的信息"><i class="fa fa-check"></i><b>1.10.2</b> 引用<code>data.frame</code>中的信息</a></li>
<li class="chapter" data-level="1.10.3" data-path="01-intro.html"><a href="01-intro.html#查看base-r自带的数据"><i class="fa fa-check"></i><b>1.10.3</b> 查看base R自带的数据</a></li>
<li class="chapter" data-level="1.10.4" data-path="01-intro.html"><a href="01-intro.html#查看数据表的常用命令"><i class="fa fa-check"></i><b>1.10.4</b> 查看数据表的常用命令</a></li>
<li class="chapter" data-level="1.10.5" data-path="01-intro.html"><a href="01-intro.html#查看数据表的其他性质"><i class="fa fa-check"></i><b>1.10.5</b> 查看数据表的其他性质</a></li>
<li class="chapter" data-level="1.10.6" data-path="01-intro.html"><a href="01-intro.html#合并数据表"><i class="fa fa-check"></i><b>1.10.6</b> 合并数据表</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="01-intro.html"><a href="01-intro.html#读入数据"><i class="fa fa-check"></i><b>1.11</b> 读入数据</a></li>
<li class="chapter" data-level="1.12" data-path="01-intro.html"><a href="01-intro.html#输出数据"><i class="fa fa-check"></i><b>1.12</b> 输出数据</a></li>
<li class="chapter" data-level="1.13" data-path="01-intro.html"><a href="01-intro.html#base-r简单作图"><i class="fa fa-check"></i><b>1.13</b> Base R简单作图</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="01-intro.html"><a href="01-intro.html#默认的plot函数"><i class="fa fa-check"></i><b>1.13.1</b> 默认的<code>plot()</code>函数</a></li>
<li class="chapter" data-level="1.13.2" data-path="01-intro.html"><a href="01-intro.html#修改为折线图"><i class="fa fa-check"></i><b>1.13.2</b> 修改为折线图</a></li>
<li class="chapter" data-level="1.13.3" data-path="01-intro.html"><a href="01-intro.html#修改颜色设置"><i class="fa fa-check"></i><b>1.13.3</b> 修改颜色设置</a></li>
<li class="chapter" data-level="1.13.4" data-path="01-intro.html"><a href="01-intro.html#修改坐标轴名称"><i class="fa fa-check"></i><b>1.13.4</b> 修改坐标轴名称</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="01-intro.html"><a href="01-intro.html#ggplot作图"><i class="fa fa-check"></i><b>1.14</b> <code>ggplot</code>作图</a></li>
<li class="chapter" data-level="1.15" data-path="01-intro.html"><a href="01-intro.html#保存图片"><i class="fa fa-check"></i><b>1.15</b> 保存图片</a>
<ul>
<li class="chapter" data-level="1.15.1" data-path="01-intro.html"><a href="01-intro.html#第一种方法"><i class="fa fa-check"></i><b>1.15.1</b> 第一种方法</a></li>
</ul></li>
<li class="chapter" data-level="1.16" data-path="01-intro.html"><a href="01-intro.html#保存图片-1"><i class="fa fa-check"></i><b>1.16</b> 保存图片</a>
<ul>
<li class="chapter" data-level="1.16.1" data-path="01-intro.html"><a href="01-intro.html#第二种方法"><i class="fa fa-check"></i><b>1.16.1</b> 第二种方法</a></li>
<li class="chapter" data-level="1.16.2" data-path="01-intro.html"><a href="01-intro.html#推荐阅读"><i class="fa fa-check"></i><b>1.16.2</b> 推荐阅读</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="03-dplyr.html"><a href="03-dplyr.html"><i class="fa fa-check"></i><b>2</b> <code>ggplot2</code>作图入门</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="03-dplyr.html"><a href="03-dplyr.html#ggplot基本理念"><i class="fa fa-check"></i><b>2.0.1</b> ggplot基本理念</a></li>
<li class="chapter" data-level="2.1" data-path="03-dplyr.html"><a href="03-dplyr.html#以r自带的数据toothgrowth为例"><i class="fa fa-check"></i><b>2.1</b> 以R自带的数据<strong><code>ToothGrowth</code></strong>为例</a></li>
<li class="chapter" data-level="2.2" data-path="03-dplyr.html"><a href="03-dplyr.html#开始作图"><i class="fa fa-check"></i><b>2.2</b> 开始作图</a></li>
<li class="chapter" data-level="2.3" data-path="03-dplyr.html"><a href="03-dplyr.html#用颜色color区分不同处理"><i class="fa fa-check"></i><b>2.3</b> 用颜色”<strong><code>color=</code></strong>”区分不同处理</a></li>
<li class="chapter" data-level="2.4" data-path="03-dplyr.html"><a href="03-dplyr.html#用形状shape进一步区分不同处理"><i class="fa fa-check"></i><b>2.4</b> 用形状”<strong><code>shape=</code></strong>”进一步区分不同处理</a></li>
<li class="chapter" data-level="2.5" data-path="03-dplyr.html"><a href="03-dplyr.html#用stat_summary添加平均值"><i class="fa fa-check"></i><b>2.5</b> 用”<strong><code>stat_summary()</code></strong>”添加平均值</a></li>
<li class="chapter" data-level="2.6" data-path="03-dplyr.html"><a href="03-dplyr.html#用stat_summary添加平均值-1"><i class="fa fa-check"></i><b>2.6</b> 用”<strong><code>stat_summary()</code></strong>”添加平均值</a></li>
<li class="chapter" data-level="2.7" data-path="03-dplyr.html"><a href="03-dplyr.html#用stat_summary添加误差棒"><i class="fa fa-check"></i><b>2.7</b> 用”<strong><code>stat_summary()</code></strong>”添加误差棒</a></li>
<li class="chapter" data-level="2.8" data-path="03-dplyr.html"><a href="03-dplyr.html#用stat_summary添加误差棒-1"><i class="fa fa-check"></i><b>2.8</b> 用”<strong><code>stat_summary()</code></strong>”添加误差棒</a></li>
<li class="chapter" data-level="2.9" data-path="03-dplyr.html"><a href="03-dplyr.html#甚至是这样的"><i class="fa fa-check"></i><b>2.9</b> 甚至是这样的</a></li>
<li class="chapter" data-level="2.10" data-path="03-dplyr.html"><a href="03-dplyr.html#这样才是好的格式这叫tidy-data"><i class="fa fa-check"></i><b>2.10</b> 这样才是好的格式，这叫<strong>Tidy Data</strong></a></li>
<li class="chapter" data-level="2.11" data-path="03-dplyr.html"><a href="03-dplyr.html#tidy-data-整齐数据"><i class="fa fa-check"></i><b>2.11</b> Tidy Data 整齐数据</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="03-dplyr.html"><a href="03-dplyr.html#修改细节使之规范"><i class="fa fa-check"></i><b>2.11.1</b> 修改细节，使之规范</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="03-dplyr.html"><a href="03-dplyr.html#当然用均值标准差格式的数据也可以作图"><i class="fa fa-check"></i><b>2.12</b> 当然，用“均值+标准差”格式的数据也可以作图</a></li>
<li class="chapter" data-level="2.13" data-path="03-dplyr.html"><a href="03-dplyr.html#当然用均值标注差格式的数据也可以作图"><i class="fa fa-check"></i><b>2.13</b> 当然，用“均值+标注差”格式的数据也可以作图</a></li>
<li class="chapter" data-level="2.14" data-path="03-dplyr.html"><a href="03-dplyr.html#用geom_col画柱状图"><i class="fa fa-check"></i><b>2.14</b> 用<code>geom_col()</code>画柱状图</a>
<ul>
<li class="chapter" data-level="2.14.1" data-path="03-dplyr.html"><a href="03-dplyr.html#柱子的颜色用fill柱子的边框才是color"><i class="fa fa-check"></i><b>2.14.1</b> 柱子的颜色用<strong><code>fill</code></strong>，柱子的边框才是<strong><code>color</code></strong></a></li>
<li class="chapter" data-level="2.14.2" data-path="03-dplyr.html"><a href="03-dplyr.html#若有多组柱子需要dodge让他们错开否则默认stack堆叠"><i class="fa fa-check"></i><b>2.14.2</b> 若有多组柱子，需要<code>dodge</code>让他们错开，否则默认<code>stack</code>堆叠</a></li>
<li class="chapter" data-level="2.14.3" data-path="03-dplyr.html"><a href="03-dplyr.html#用position-position_dodge错开多组误差棒"><i class="fa fa-check"></i><b>2.14.3</b> 用<strong><code>position = position_dodge()</code></strong>，错开多组误差棒</a></li>
<li class="chapter" data-level="2.14.4" data-path="03-dplyr.html"><a href="03-dplyr.html#把x轴的dose变为factor类型使柱子之间等间隔"><i class="fa fa-check"></i><b>2.14.4</b> 把x轴的<code>dose</code>变为<code>factor</code>类型，使柱子之间等间隔</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="03-dplyr.html"><a href="03-dplyr.html#修改细节使之规范-1"><i class="fa fa-check"></i><b>2.15</b> 修改细节，使之规范</a></li>
<li class="chapter" data-level="2.16" data-path="03-dplyr.html"><a href="03-dplyr.html#直接用tidy-datatoothgrowth作柱状图"><i class="fa fa-check"></i><b>2.16</b> 直接用<code>Tidy Data</code>（<code>ToothGrowth</code>）作柱状图</a></li>
<li class="chapter" data-level="2.17" data-path="03-dplyr.html"><a href="03-dplyr.html#用geom_boxplot画箱式图"><i class="fa fa-check"></i><b>2.17</b> 用<code>geom_boxplot()</code>画箱式图</a></li>
<li class="chapter" data-level="2.18" data-path="03-dplyr.html"><a href="03-dplyr.html#用factor将数值变量转化为因子"><i class="fa fa-check"></i><b>2.18</b> 用<code>factor()</code>将数值变量转化为因子</a></li>
<li class="chapter" data-level="2.19" data-path="03-dplyr.html"><a href="03-dplyr.html#要点小结"><i class="fa fa-check"></i><b>2.19</b> 要点小结</a></li>
<li class="chapter" data-level="2.20" data-path="03-dplyr.html"><a href="03-dplyr.html#阅读作业"><i class="fa fa-check"></i><b>2.20</b> 阅读作业</a>
<ul>
<li class="chapter" data-level="2.20.1" data-path="03-dplyr.html"><a href="03-dplyr.html#hadley-wickham.-2016.-ggplot2-elegant-graphics-for-data-analysis."><i class="fa fa-check"></i><b>2.20.1</b> Hadley Wickham. 2016. ggplot2 Elegant Graphics for Data Analysis.</a></li>
</ul></li>
<li class="chapter" data-level="2.21" data-path="03-dplyr.html"><a href="03-dplyr.html#进阶拟合及结果可视化"><i class="fa fa-check"></i><b>2.21</b> 进阶：拟合及结果可视化</a></li>
<li class="chapter" data-level="2.22" data-path="03-dplyr.html"><a href="03-dplyr.html#先用head和str来查看数据"><i class="fa fa-check"></i><b>2.22</b> 先用<strong><code>head()</code></strong>和<strong><code>str()</code></strong>来查看数据</a></li>
<li class="chapter" data-level="2.23" data-path="03-dplyr.html"><a href="03-dplyr.html#散点图是我们对数据进行探索分析的法宝"><i class="fa fa-check"></i><b>2.23</b> 散点图是我们对数据进行探索分析的法宝</a></li>
<li class="chapter" data-level="2.24" data-path="03-dplyr.html"><a href="03-dplyr.html#均值标准差换一种方法"><i class="fa fa-check"></i><b>2.24</b> 均值+标准差（换一种方法）</a></li>
<li class="chapter" data-level="2.25" data-path="03-dplyr.html"><a href="03-dplyr.html#对比两种等价的作图方法"><i class="fa fa-check"></i><b>2.25</b> 对比两种等价的作图方法</a></li>
<li class="chapter" data-level="2.26" data-path="03-dplyr.html"><a href="03-dplyr.html#nls非线性拟合米氏方程手动提取拟合结果"><i class="fa fa-check"></i><b>2.26</b> <strong><code>nls()</code></strong>非线性拟合米氏方程：手动提取拟合结果</a></li>
<li class="chapter" data-level="2.27" data-path="03-dplyr.html"><a href="03-dplyr.html#nls非线性拟合米氏方程自动提取拟合结果-1"><i class="fa fa-check"></i><b>2.27</b> <strong><code>nls()</code></strong>非线性拟合米氏方程：自动提取拟合结果-1</a></li>
<li class="chapter" data-level="2.28" data-path="03-dplyr.html"><a href="03-dplyr.html#nls非线性拟合米氏方程自动提取拟合结果-2"><i class="fa fa-check"></i><b>2.28</b> <strong><code>nls()</code></strong>非线性拟合米氏方程：自动提取拟合结果-2</a></li>
<li class="chapter" data-level="2.29" data-path="03-dplyr.html"><a href="03-dplyr.html#生成画拟合线所需的数据"><i class="fa fa-check"></i><b>2.29</b> 生成画拟合线所需的数据</a></li>
<li class="chapter" data-level="2.30" data-path="03-dplyr.html"><a href="03-dplyr.html#添加拟合线"><i class="fa fa-check"></i><b>2.30</b> 添加拟合线</a></li>
<li class="chapter" data-level="2.31" data-path="03-dplyr.html"><a href="03-dplyr.html#修饰细节"><i class="fa fa-check"></i><b>2.31</b> 修饰细节</a></li>
<li class="chapter" data-level="2.32" data-path="03-dplyr.html"><a href="03-dplyr.html#如何在图上添加数学公式"><i class="fa fa-check"></i><b>2.32</b> 如何在图上添加数学公式？</a></li>
<li class="chapter" data-level="2.33" data-path="03-dplyr.html"><a href="03-dplyr.html#另一个探索数据的超级武器分面facet"><i class="fa fa-check"></i><b>2.33</b> 另一个探索数据的超级武器：分面<strong><code>facet</code></strong></a></li>
<li class="chapter" data-level="2.34" data-path="03-dplyr.html"><a href="03-dplyr.html#运用for循环语句批量拟合11组数据"><i class="fa fa-check"></i><b>2.34</b> 运用<code>for()</code>循环语句，批量拟合11组数据</a></li>
<li class="chapter" data-level="2.35" data-path="03-dplyr.html"><a href="03-dplyr.html#生成画11条拟合线的数据"><i class="fa fa-check"></i><b>2.35</b> 生成画11条拟合线的数据</a></li>
<li class="chapter" data-level="2.36" data-path="03-dplyr.html"><a href="03-dplyr.html#画11条拟合线"><i class="fa fa-check"></i><b>2.36</b> 画11条拟合线</a></li>
<li class="chapter" data-level="2.37" data-path="03-dplyr.html"><a href="03-dplyr.html#修改细节"><i class="fa fa-check"></i><b>2.37</b> 修改细节</a></li>
<li class="chapter" data-level="2.38" data-path="03-dplyr.html"><a href="03-dplyr.html#目前的数据存在哪些问题"><i class="fa fa-check"></i><b>2.38</b> 目前的数据存在哪些问题：</a>
<ul>
<li class="chapter" data-level="2.38.1" data-path="03-dplyr.html"><a href="03-dplyr.html#数据太大冗余信息过多"><i class="fa fa-check"></i><b>2.38.1</b> 1. 数据太大，冗余信息过多</a></li>
<li class="chapter" data-level="2.38.2" data-path="03-dplyr.html"><a href="03-dplyr.html#存在干重湿重两种不同的单位"><i class="fa fa-check"></i><b>2.38.2</b> 2. 存在干重、湿重两种不同的单位</a></li>
</ul></li>
<li class="chapter" data-level="2.39" data-path="03-dplyr.html"><a href="03-dplyr.html#整理数据用select筛选数据的特定列"><i class="fa fa-check"></i><b>2.39</b> 整理数据：用<code>select()</code>筛选数据的特定列</a>
<ul>
<li class="chapter" data-level="2.39.1" data-path="03-dplyr.html"><a href="03-dplyr.html#使用列名来选择列"><i class="fa fa-check"></i><b>2.39.1</b> 使用“列名”来选择列</a></li>
<li class="chapter" data-level="2.39.2" data-path="03-dplyr.html"><a href="03-dplyr.html#也可以用列号进行选择"><i class="fa fa-check"></i><b>2.39.2</b> 也可以用“列号”进行选择</a></li>
</ul></li>
<li class="chapter" data-level="2.40" data-path="03-dplyr.html"><a href="03-dplyr.html#数据整理-用filter筛选数据的特定行"><i class="fa fa-check"></i><b>2.40</b> 数据整理： 用<code>filter()</code>筛选数据的特定行</a>
<ul>
<li class="chapter" data-level="2.40.1" data-path="03-dplyr.html"><a href="03-dplyr.html#筛选出牡蛎和贻贝的数据"><i class="fa fa-check"></i><b>2.40.1</b> 筛选出牡蛎和贻贝的数据</a></li>
<li class="chapter" data-level="2.40.2" data-path="03-dplyr.html"><a href="03-dplyr.html#检查一下新的数据"><i class="fa fa-check"></i><b>2.40.2</b> 检查一下新的数据</a></li>
<li class="chapter" data-level="2.40.3" data-path="03-dplyr.html"><a href="03-dplyr.html#再次查看数据的单位"><i class="fa fa-check"></i><b>2.40.3</b> 再次查看数据的单位</a></li>
<li class="chapter" data-level="2.40.4" data-path="03-dplyr.html"><a href="03-dplyr.html#也可以用base-r的subset筛选数据"><i class="fa fa-check"></i><b>2.40.4</b> 也可以用base R的<code>subset()</code>筛选数据</a></li>
</ul></li>
<li class="chapter" data-level="2.41" data-path="03-dplyr.html"><a href="03-dplyr.html#注意区分filter和select"><i class="fa fa-check"></i><b>2.41</b> 注意区分<code>filter()</code>和<code>select()</code></a>
<ul>
<li class="chapter" data-level="2.41.1" data-path="03-dplyr.html"><a href="03-dplyr.html#筛选出cd的数据"><i class="fa fa-check"></i><b>2.41.1</b> 筛选出Cd的数据</a></li>
<li class="chapter" data-level="2.41.2" data-path="03-dplyr.html"><a href="03-dplyr.html#可以作个图看看数据了"><i class="fa fa-check"></i><b>2.41.2</b> 可以作个图看看数据了</a></li>
<li class="chapter" data-level="2.41.3" data-path="03-dplyr.html"><a href="03-dplyr.html#去掉只有2个数据点的物种"><i class="fa fa-check"></i><b>2.41.3</b> 去掉只有2个数据点的物种</a></li>
<li class="chapter" data-level="2.41.4" data-path="03-dplyr.html"><a href="03-dplyr.html#研究问题1牡蛎贻贝谁的cd浓度高"><i class="fa fa-check"></i><b>2.41.4</b> 研究问题1：牡蛎、贻贝，谁的Cd浓度高？</a></li>
<li class="chapter" data-level="2.41.5" data-path="03-dplyr.html"><a href="03-dplyr.html#按中位值排序"><i class="fa fa-check"></i><b>2.41.5</b> 按中位值排序</a></li>
<li class="chapter" data-level="2.41.6" data-path="03-dplyr.html"><a href="03-dplyr.html#按中位值排序-1"><i class="fa fa-check"></i><b>2.41.6</b> 按中位值排序</a></li>
<li class="chapter" data-level="2.41.7" data-path="03-dplyr.html"><a href="03-dplyr.html#修饰细节-1"><i class="fa fa-check"></i><b>2.41.7</b> 修饰细节</a></li>
</ul></li>
<li class="chapter" data-level="2.42" data-path="03-dplyr.html"><a href="03-dplyr.html#用group_by和summarise分组计算均值标准差"><i class="fa fa-check"></i><b>2.42</b> 用<code>group_by</code>和<code>summarise</code>分组计算均值、标准差</a></li>
<li class="chapter" data-level="2.43" data-path="03-dplyr.html"><a href="03-dplyr.html#研究问题2"><i class="fa fa-check"></i><b>2.43</b> 研究问题2：</a>
<ul>
<li class="chapter" data-level="2.43.1" data-path="03-dplyr.html"><a href="03-dplyr.html#zn浓度高的牡蛎是否cd浓度也高"><i class="fa fa-check"></i><b>2.43.1</b> Zn浓度高的牡蛎，是否Cd浓度也高？</a></li>
<li class="chapter" data-level="2.43.2" data-path="03-dplyr.html"><a href="03-dplyr.html#整理数据"><i class="fa fa-check"></i><b>2.43.2</b> 整理数据</a></li>
<li class="chapter" data-level="2.43.3" data-path="03-dplyr.html"><a href="03-dplyr.html#查看整理好的数据"><i class="fa fa-check"></i><b>2.43.3</b> 查看整理好的数据</a></li>
<li class="chapter" data-level="2.43.4" data-path="03-dplyr.html"><a href="03-dplyr.html#把数据切分成cd数据zn数据"><i class="fa fa-check"></i><b>2.43.4</b> 把数据切分成<code>Cd</code>数据、<code>Zn</code>数据</a></li>
<li class="chapter" data-level="2.43.5" data-path="03-dplyr.html"><a href="03-dplyr.html#运用inner_join合并两套数据"><i class="fa fa-check"></i><b>2.43.5</b> 运用<code>inner_join()</code>合并两套数据</a></li>
<li class="chapter" data-level="2.43.6" data-path="03-dplyr.html"><a href="03-dplyr.html#join系列函数"><i class="fa fa-check"></i><b>2.43.6</b> <code>join</code>系列函数</a></li>
<li class="chapter" data-level="2.43.7" data-path="03-dplyr.html"><a href="03-dplyr.html#作散点图初步了解数据"><i class="fa fa-check"></i><b>2.43.7</b> 作散点图初步了解数据</a></li>
<li class="chapter" data-level="2.43.8" data-path="03-dplyr.html"><a href="03-dplyr.html#使用双对数坐标"><i class="fa fa-check"></i><b>2.43.8</b> 使用双对数坐标</a></li>
<li class="chapter" data-level="2.43.9" data-path="03-dplyr.html"><a href="03-dplyr.html#按不同物种分面作图"><i class="fa fa-check"></i><b>2.43.9</b> 按不同物种分面作图</a></li>
<li class="chapter" data-level="2.43.10" data-path="03-dplyr.html"><a href="03-dplyr.html#添加拟合线帮助判断趋势"><i class="fa fa-check"></i><b>2.43.10</b> 添加拟合线，帮助判断趋势</a></li>
<li class="chapter" data-level="2.43.11" data-path="03-dplyr.html"><a href="03-dplyr.html#美化一下"><i class="fa fa-check"></i><b>2.43.11</b> 美化一下</a></li>
<li class="chapter" data-level="2.43.12" data-path="03-dplyr.html"><a href="03-dplyr.html#成品"><i class="fa fa-check"></i><b>2.43.12</b> 成品</a></li>
</ul></li>
<li class="chapter" data-level="2.44" data-path="03-dplyr.html"><a href="03-dplyr.html#要点小结-1"><i class="fa fa-check"></i><b>2.44</b> 要点小结</a></li>
<li class="chapter" data-level="2.45" data-path="03-dplyr.html"><a href="03-dplyr.html#要点小结-2"><i class="fa fa-check"></i><b>2.45</b> 要点小结</a>
<ul>
<li class="chapter" data-level="2.45.1" data-path="03-dplyr.html"><a href="03-dplyr.html#运算符"><i class="fa fa-check"></i><b>2.45.1</b> “<code>%&gt;%</code>”运算符</a></li>
</ul></li>
<li class="chapter" data-level="2.46" data-path="03-dplyr.html"><a href="03-dplyr.html#练习"><i class="fa fa-check"></i><b>2.46</b> 练习</a></li>
<li class="chapter" data-level="2.47" data-path="03-dplyr.html"><a href="03-dplyr.html#阅读"><i class="fa fa-check"></i><b>2.47</b> 阅读：</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="04-lubridate.html"><a href="04-lubridate.html"><i class="fa fa-check"></i><b>3</b> <code>lubridate</code>处理时间数据</a>
<ul>
<li class="chapter" data-level="3.1" data-path="04-lubridate.html"><a href="04-lubridate.html#时间格式转化"><i class="fa fa-check"></i><b>3.1</b> 时间格式转化</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="04-lubridate.html"><a href="04-lubridate.html#字符串转化为日期date格式"><i class="fa fa-check"></i><b>3.1.1</b> 字符串转化为日期（<code>Date</code>）格式</a></li>
<li class="chapter" data-level="3.1.2" data-path="04-lubridate.html"><a href="04-lubridate.html#字符串转化为日期date格式-1"><i class="fa fa-check"></i><b>3.1.2</b> 字符串转化为日期（<code>Date</code>）格式</a></li>
<li class="chapter" data-level="3.1.3" data-path="04-lubridate.html"><a href="04-lubridate.html#字符串转化为日期-时间date-time格式"><i class="fa fa-check"></i><b>3.1.3</b> 字符串转化为日期-时间（<code>date-time</code>）格式</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="04-lubridate.html"><a href="04-lubridate.html#时间信息提取"><i class="fa fa-check"></i><b>3.2</b> 时间信息提取</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="04-lubridate.html"><a href="04-lubridate.html#提取日期数据中的信息"><i class="fa fa-check"></i><b>3.2.1</b> 提取日期数据中的信息</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="04-lubridate.html"><a href="04-lubridate.html#提取日期-时间数据中的信息"><i class="fa fa-check"></i><b>3.3</b> 提取日期-时间数据中的信息</a></li>
<li class="chapter" data-level="3.4" data-path="04-lubridate.html"><a href="04-lubridate.html#时区"><i class="fa fa-check"></i><b>3.4</b> 时区</a></li>
<li class="chapter" data-level="3.5" data-path="04-lubridate.html"><a href="04-lubridate.html#时区-1"><i class="fa fa-check"></i><b>3.5</b> 时区</a></li>
<li class="chapter" data-level="3.6" data-path="04-lubridate.html"><a href="04-lubridate.html#时间计算"><i class="fa fa-check"></i><b>3.6</b> 时间计算</a></li>
<li class="chapter" data-level="3.7" data-path="04-lubridate.html"><a href="04-lubridate.html#时间数据可视化"><i class="fa fa-check"></i><b>3.7</b> 时间数据可视化</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="04-lubridate.html"><a href="04-lubridate.html#厦门空气质量数据分析"><i class="fa fa-check"></i><b>3.7.1</b> 厦门空气质量数据分析</a></li>
<li class="chapter" data-level="3.7.2" data-path="04-lubridate.html"><a href="04-lubridate.html#年厦门pm2.5逐日变化趋势"><i class="fa fa-check"></i><b>3.7.2</b> 2021年厦门PM2.5逐日变化趋势</a></li>
<li class="chapter" data-level="3.7.3" data-path="04-lubridate.html"><a href="04-lubridate.html#年厦门pm2.5逐日变化趋势调整细节"><i class="fa fa-check"></i><b>3.7.3</b> 2021年厦门PM2.5逐日变化趋势：调整细节</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="04-lubridate.html"><a href="04-lubridate.html#strptime查看日期时间格式"><i class="fa fa-check"></i><b>3.8</b> <code>?strptime</code>查看日期时间格式</a></li>
<li class="chapter" data-level="3.9" data-path="04-lubridate.html"><a href="04-lubridate.html#合并四年数据用于分析"><i class="fa fa-check"></i><b>3.9</b> 合并四年数据用于分析</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="04-lubridate.html"><a href="04-lubridate.html#了解合并数据的结构尤其是数据类型"><i class="fa fa-check"></i><b>3.9.1</b> 了解合并数据的结构，尤其是数据类型</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="04-lubridate.html"><a href="04-lubridate.html#数据整理"><i class="fa fa-check"></i><b>3.10</b> 数据整理</a></li>
<li class="chapter" data-level="3.11" data-path="04-lubridate.html"><a href="04-lubridate.html#缺哪天的数据"><i class="fa fa-check"></i><b>3.11</b> 缺哪天的数据？</a></li>
<li class="chapter" data-level="3.12" data-path="04-lubridate.html"><a href="04-lubridate.html#总体趋势厦门aqi的4年趋势"><i class="fa fa-check"></i><b>3.12</b> 总体趋势：厦门AQI的4年趋势</a></li>
<li class="chapter" data-level="3.13" data-path="04-lubridate.html"><a href="04-lubridate.html#总体趋势一并查看6项指标"><i class="fa fa-check"></i><b>3.13</b> 总体趋势：一并查看6项指标</a></li>
<li class="chapter" data-level="3.14" data-path="04-lubridate.html"><a href="04-lubridate.html#细看季节趋势pm2.5"><i class="fa fa-check"></i><b>3.14</b> 细看季节趋势：PM2.5</a></li>
<li class="chapter" data-level="3.15" data-path="04-lubridate.html"><a href="04-lubridate.html#细看各个月份各月份的pm2.5概率密度分布"><i class="fa fa-check"></i><b>3.15</b> 细看各个月份：各月份的PM2.5概率密度分布</a></li>
<li class="chapter" data-level="3.16" data-path="04-lubridate.html"><a href="04-lubridate.html#对比各月份与总体的pm2.5概率密度分布"><i class="fa fa-check"></i><b>3.16</b> 对比各月份与总体的PM2.5概率密度分布</a></li>
<li class="chapter" data-level="3.17" data-path="04-lubridate.html"><a href="04-lubridate.html#对比各月份与总体的pm2.5概率密度分布-1"><i class="fa fa-check"></i><b>3.17</b> 对比各月份与总体的PM2.5概率密度分布</a></li>
<li class="chapter" data-level="3.18" data-path="04-lubridate.html"><a href="04-lubridate.html#季节趋势总览全部参数"><i class="fa fa-check"></i><b>3.18</b> 季节趋势：总览全部参数</a></li>
<li class="chapter" data-level="3.19" data-path="04-lubridate.html"><a href="04-lubridate.html#工作日-周末趋势pm2.5"><i class="fa fa-check"></i><b>3.19</b> 工作日-周末趋势：PM2.5</a></li>
<li class="chapter" data-level="3.20" data-path="04-lubridate.html"><a href="04-lubridate.html#昼夜趋势臭氧"><i class="fa fa-check"></i><b>3.20</b> 昼夜趋势：臭氧</a></li>
<li class="chapter" data-level="3.21" data-path="04-lubridate.html"><a href="04-lubridate.html#昼夜趋势臭氧-1"><i class="fa fa-check"></i><b>3.21</b> 昼夜趋势：臭氧</a></li>
<li class="chapter" data-level="3.22" data-path="04-lubridate.html"><a href="04-lubridate.html#昼夜趋势臭氧-2"><i class="fa fa-check"></i><b>3.22</b> 昼夜趋势：臭氧</a></li>
<li class="chapter" data-level="3.23" data-path="04-lubridate.html"><a href="04-lubridate.html#拓展阅读"><i class="fa fa-check"></i><b>3.23</b> 拓展阅读</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="05-map.html"><a href="05-map.html"><i class="fa fa-check"></i><b>4</b> 绘制地图</a></li>
<li class="chapter" data-level="5" data-path="06-correlation.html"><a href="06-correlation.html"><i class="fa fa-check"></i><b>5</b> 相关性分析</a></li>
<li class="chapter" data-level="6" data-path="07-mlr.html"><a href="07-mlr.html"><i class="fa fa-check"></i><b>6</b> 线性回归</a></li>
<li class="chapter" data-level="7" data-path="08-logistic.html"><a href="08-logistic.html"><i class="fa fa-check"></i><b>7</b> Logistic回归</a></li>
<li class="chapter" data-level="8" data-path="09-ttest.html"><a href="09-ttest.html"><i class="fa fa-check"></i><b>8</b> <em>t</em>检验</a></li>
<li class="chapter" data-level="9" data-path="10-anova.html"><a href="10-anova.html"><i class="fa fa-check"></i><b>9</b> 单因素方差分析</a></li>
<li class="chapter" data-level="10" data-path="11-2wayanova.html"><a href="11-2wayanova.html"><i class="fa fa-check"></i><b>10</b> 多因素方差分析</a></li>
<li class="chapter" data-level="11" data-path="12-ancova.html"><a href="12-ancova.html"><i class="fa fa-check"></i><b>11</b> 协方差分析</a></li>
<li class="chapter" data-level="12" data-path="13-pca.html"><a href="13-pca.html"><i class="fa fa-check"></i><b>12</b> 主成分分析</a></li>
<li class="chapter" data-level="" data-path="14-reference.html"><a href="14-reference.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">环境数据分析与可视化</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lubridate处理时间数据" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> <code>lubridate</code>处理时间数据<a href="04-lubridate.html#lubridate处理时间数据" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>加载程序包</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="04-lubridate.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#作图</span></span>
<span id="cb346-2"><a href="04-lubridate.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co">#读取excel文件</span></span>
<span id="cb346-3"><a href="04-lubridate.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co">#处理时间数据</span></span></code></pre></div>
<div id="时间格式转化" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 时间格式转化<a href="04-lubridate.html#时间格式转化" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="字符串转化为日期date格式" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 字符串转化为日期（<code>Date</code>）格式<a href="04-lubridate.html#字符串转化为日期date格式" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="04-lubridate.html#cb347-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&quot;20220318&quot;</span> <span class="co"># a是字符格式</span></span>
<span id="cb347-2"><a href="04-lubridate.html#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="04-lubridate.html#cb349-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ymd</span>(a) <span class="co">#将a转化为日期格式</span></span>
<span id="cb349-2"><a href="04-lubridate.html#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(b)</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="04-lubridate.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ymd，ydm，mdy，myd等系列函数，`?ymd`查看  </span></span>
<span id="cb351-2"><a href="04-lubridate.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(<span class="st">&quot;03/18/2022&quot;</span>) </span></code></pre></div>
<pre><code>## [1] &quot;2022-03-18&quot;</code></pre>
<p><strong>日期格式自由，均能正确转化</strong></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="04-lubridate.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">&quot;2022/03/18&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-03-18&quot;</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="04-lubridate.html#cb355-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20090101</span>, <span class="st">&quot;2009-01-02&quot;</span>, <span class="st">&quot;2009 01 03&quot;</span>, <span class="st">&quot;2009-1-4&quot;</span>, <span class="st">&quot;2009-1, 5&quot;</span>, <span class="st">&quot;Created on 2009 1 6&quot;</span>, <span class="st">&quot;200901 !!! 07&quot;</span>)</span>
<span id="cb355-2"><a href="04-lubridate.html#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(x)</span></code></pre></div>
<pre><code>## [1] &quot;2009-01-01&quot; &quot;2009-01-02&quot; &quot;2009-01-03&quot; &quot;2009-01-04&quot; &quot;2009-01-05&quot;
## [6] &quot;2009-01-06&quot; &quot;2009-01-07&quot;</code></pre>
</div>
<div id="字符串转化为日期date格式-1" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> 字符串转化为日期（<code>Date</code>）格式<a href="04-lubridate.html#字符串转化为日期date格式-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以下两个函数对输入格式有较严格要求</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="04-lubridate.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&quot;2022-03-12&quot;</span>)  <span class="co"># 分隔号-</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-12&quot;</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="04-lubridate.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">&quot;2022/12/03&quot;</span>) <span class="co">#分隔号/</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-12-03&quot;</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="04-lubridate.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>(<span class="st">&quot;2022-03-18&quot;</span>) <span class="co"># 分隔号-</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-18&quot;</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="04-lubridate.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span>(<span class="st">&quot;2022/03/18&quot;</span>) <span class="co">#分隔号/</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-03-18&quot;</code></pre>
</div>
<div id="字符串转化为日期-时间date-time格式" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> 字符串转化为日期-时间（<code>date-time</code>）格式<a href="04-lubridate.html#字符串转化为日期-时间date-time格式" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="04-lubridate.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="st">&quot;2011-06-05 12:00:00&quot;</span>) <span class="co">#年月日 时分秒</span></span></code></pre></div>
<pre><code>## [1] &quot;2011-06-05 12:00:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="04-lubridate.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hm</span>(<span class="st">&quot;2011-06-05 12:23&quot;</span>) <span class="co">#年月日 时分；秒自动设置为0</span></span></code></pre></div>
<pre><code>## [1] &quot;2011-06-05 12:23:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="04-lubridate.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_h</span>(<span class="st">&quot;2011-06-05 12&quot;</span>) <span class="co">#年月日 时；分秒自动设置为0</span></span></code></pre></div>
<pre><code>## [1] &quot;2011-06-05 12:00:00 UTC&quot;</code></pre>
</div>
</div>
<div id="时间信息提取" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 时间信息提取<a href="04-lubridate.html#时间信息提取" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="提取日期数据中的信息" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> 提取日期数据中的信息<a href="04-lubridate.html#提取日期数据中的信息" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="04-lubridate.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">today</span>() <span class="co">#今天的日期 </span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07&quot;</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="04-lubridate.html#cb373-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">today</span>() </span>
<span id="cb373-2"><a href="04-lubridate.html#cb373-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-3"><a href="04-lubridate.html#cb373-3" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(x) <span class="co"># 哪年？</span></span></code></pre></div>
<pre><code>## [1] 2022</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="04-lubridate.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(x) <span class="co">#哪月？</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="04-lubridate.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">day</span>(x) <span class="co">#哪日？</span></span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="04-lubridate.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(x) <span class="co">#一个星期中的第几天？（默认星期天为第1天）</span></span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="04-lubridate.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(x, <span class="at">week_start =</span> <span class="dv">1</span>) <span class="co">#一个星期中的第几天？以星期一为第1天</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
</div>
<div id="提取日期-时间数据中的信息" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 提取日期-时间数据中的信息<a href="04-lubridate.html#提取日期-时间数据中的信息" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="04-lubridate.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">now</span>() <span class="co">#现在时刻</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07 08:02:31 CST&quot;</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="04-lubridate.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>() <span class="co">#电脑系统的现在时刻</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07 08:02:31 CST&quot;</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="04-lubridate.html#cb387-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">now</span>()</span>
<span id="cb387-2"><a href="04-lubridate.html#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hour</span>(y) <span class="co">#几时？</span></span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="04-lubridate.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">minute</span>(y) <span class="co">#几分？</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="04-lubridate.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">second</span>(y)  <span class="co">#几秒？</span></span></code></pre></div>
<pre><code>## [1] 31.29709</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="04-lubridate.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(y, <span class="at">week_start =</span> <span class="dv">1</span>, <span class="at">label =</span> T ) <span class="co">#星期几？（文字表示）</span></span></code></pre></div>
<pre><code>## [1] Tue
## Levels: Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat &lt; Sun</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="04-lubridate.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">yday</span>(y) <span class="co">#一年中的第几天？</span></span></code></pre></div>
<pre><code>## [1] 158</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="04-lubridate.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">week</span>(y) <span class="co">#一年中的第几个星期？</span></span></code></pre></div>
<pre><code>## [1] 23</code></pre>
</div>
<div id="时区" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 时区<a href="04-lubridate.html#时区" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>关于时区设置：<code>?locales</code>查询<br />
关于时区名称，查看维基百科：
<a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" class="uri">https://en.wikipedia.org/wiki/List_of_tz_database_time_zones</a></p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="04-lubridate.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.timezone</span>() <span class="co">#所在时区：亚洲/上海，即北京时间</span></span></code></pre></div>
<pre><code>## [1] &quot;Asia/Shanghai&quot;</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="04-lubridate.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">OlsonNames</span>() <span class="co">#查询所有时区名称，该数据库由David Olson创立</span></span></code></pre></div>
<pre><code>##   [1] &quot;Africa/Abidjan&quot;                   &quot;Africa/Accra&quot;                    
##   [3] &quot;Africa/Addis_Ababa&quot;               &quot;Africa/Algiers&quot;                  
##   [5] &quot;Africa/Asmara&quot;                    &quot;Africa/Asmera&quot;                   
##   [7] &quot;Africa/Bamako&quot;                    &quot;Africa/Bangui&quot;                   
##   [9] &quot;Africa/Banjul&quot;                    &quot;Africa/Bissau&quot;                   
##  [11] &quot;Africa/Blantyre&quot;                  &quot;Africa/Brazzaville&quot;              
##  [13] &quot;Africa/Bujumbura&quot;                 &quot;Africa/Cairo&quot;                    
##  [15] &quot;Africa/Casablanca&quot;                &quot;Africa/Ceuta&quot;                    
##  [17] &quot;Africa/Conakry&quot;                   &quot;Africa/Dakar&quot;                    
##  [19] &quot;Africa/Dar_es_Salaam&quot;             &quot;Africa/Djibouti&quot;                 
##  [21] &quot;Africa/Douala&quot;                    &quot;Africa/El_Aaiun&quot;                 
##  [23] &quot;Africa/Freetown&quot;                  &quot;Africa/Gaborone&quot;                 
##  [25] &quot;Africa/Harare&quot;                    &quot;Africa/Johannesburg&quot;             
##  [27] &quot;Africa/Juba&quot;                      &quot;Africa/Kampala&quot;                  
##  [29] &quot;Africa/Khartoum&quot;                  &quot;Africa/Kigali&quot;                   
##  [31] &quot;Africa/Kinshasa&quot;                  &quot;Africa/Lagos&quot;                    
##  [33] &quot;Africa/Libreville&quot;                &quot;Africa/Lome&quot;                     
##  [35] &quot;Africa/Luanda&quot;                    &quot;Africa/Lubumbashi&quot;               
##  [37] &quot;Africa/Lusaka&quot;                    &quot;Africa/Malabo&quot;                   
##  [39] &quot;Africa/Maputo&quot;                    &quot;Africa/Maseru&quot;                   
##  [41] &quot;Africa/Mbabane&quot;                   &quot;Africa/Mogadishu&quot;                
##  [43] &quot;Africa/Monrovia&quot;                  &quot;Africa/Nairobi&quot;                  
##  [45] &quot;Africa/Ndjamena&quot;                  &quot;Africa/Niamey&quot;                   
##  [47] &quot;Africa/Nouakchott&quot;                &quot;Africa/Ouagadougou&quot;              
##  [49] &quot;Africa/Porto-Novo&quot;                &quot;Africa/Sao_Tome&quot;                 
##  [51] &quot;Africa/Timbuktu&quot;                  &quot;Africa/Tripoli&quot;                  
##  [53] &quot;Africa/Tunis&quot;                     &quot;Africa/Windhoek&quot;                 
##  [55] &quot;America/Adak&quot;                     &quot;America/Anchorage&quot;               
##  [57] &quot;America/Anguilla&quot;                 &quot;America/Antigua&quot;                 
##  [59] &quot;America/Araguaina&quot;                &quot;America/Argentina/Buenos_Aires&quot;  
##  [61] &quot;America/Argentina/Catamarca&quot;      &quot;America/Argentina/ComodRivadavia&quot;
##  [63] &quot;America/Argentina/Cordoba&quot;        &quot;America/Argentina/Jujuy&quot;         
##  [65] &quot;America/Argentina/La_Rioja&quot;       &quot;America/Argentina/Mendoza&quot;       
##  [67] &quot;America/Argentina/Rio_Gallegos&quot;   &quot;America/Argentina/Salta&quot;         
##  [69] &quot;America/Argentina/San_Juan&quot;       &quot;America/Argentina/San_Luis&quot;      
##  [71] &quot;America/Argentina/Tucuman&quot;        &quot;America/Argentina/Ushuaia&quot;       
##  [73] &quot;America/Aruba&quot;                    &quot;America/Asuncion&quot;                
##  [75] &quot;America/Atikokan&quot;                 &quot;America/Atka&quot;                    
##  [77] &quot;America/Bahia&quot;                    &quot;America/Bahia_Banderas&quot;          
##  [79] &quot;America/Barbados&quot;                 &quot;America/Belem&quot;                   
##  [81] &quot;America/Belize&quot;                   &quot;America/Blanc-Sablon&quot;            
##  [83] &quot;America/Boa_Vista&quot;                &quot;America/Bogota&quot;                  
##  [85] &quot;America/Boise&quot;                    &quot;America/Buenos_Aires&quot;            
##  [87] &quot;America/Cambridge_Bay&quot;            &quot;America/Campo_Grande&quot;            
##  [89] &quot;America/Cancun&quot;                   &quot;America/Caracas&quot;                 
##  [91] &quot;America/Catamarca&quot;                &quot;America/Cayenne&quot;                 
##  [93] &quot;America/Cayman&quot;                   &quot;America/Chicago&quot;                 
##  [95] &quot;America/Chihuahua&quot;                &quot;America/Coral_Harbour&quot;           
##  [97] &quot;America/Cordoba&quot;                  &quot;America/Costa_Rica&quot;              
##  [99] &quot;America/Creston&quot;                  &quot;America/Cuiaba&quot;                  
## [101] &quot;America/Curacao&quot;                  &quot;America/Danmarkshavn&quot;            
## [103] &quot;America/Dawson&quot;                   &quot;America/Dawson_Creek&quot;            
## [105] &quot;America/Denver&quot;                   &quot;America/Detroit&quot;                 
## [107] &quot;America/Dominica&quot;                 &quot;America/Edmonton&quot;                
## [109] &quot;America/Eirunepe&quot;                 &quot;America/El_Salvador&quot;             
## [111] &quot;America/Ensenada&quot;                 &quot;America/Fort_Nelson&quot;             
## [113] &quot;America/Fort_Wayne&quot;               &quot;America/Fortaleza&quot;               
## [115] &quot;America/Glace_Bay&quot;                &quot;America/Godthab&quot;                 
## [117] &quot;America/Goose_Bay&quot;                &quot;America/Grand_Turk&quot;              
## [119] &quot;America/Grenada&quot;                  &quot;America/Guadeloupe&quot;              
## [121] &quot;America/Guatemala&quot;                &quot;America/Guayaquil&quot;               
## [123] &quot;America/Guyana&quot;                   &quot;America/Halifax&quot;                 
## [125] &quot;America/Havana&quot;                   &quot;America/Hermosillo&quot;              
## [127] &quot;America/Indiana/Indianapolis&quot;     &quot;America/Indiana/Knox&quot;            
## [129] &quot;America/Indiana/Marengo&quot;          &quot;America/Indiana/Petersburg&quot;      
## [131] &quot;America/Indiana/Tell_City&quot;        &quot;America/Indiana/Vevay&quot;           
## [133] &quot;America/Indiana/Vincennes&quot;        &quot;America/Indiana/Winamac&quot;         
## [135] &quot;America/Indianapolis&quot;             &quot;America/Inuvik&quot;                  
## [137] &quot;America/Iqaluit&quot;                  &quot;America/Jamaica&quot;                 
## [139] &quot;America/Jujuy&quot;                    &quot;America/Juneau&quot;                  
## [141] &quot;America/Kentucky/Louisville&quot;      &quot;America/Kentucky/Monticello&quot;     
## [143] &quot;America/Knox_IN&quot;                  &quot;America/Kralendijk&quot;              
## [145] &quot;America/La_Paz&quot;                   &quot;America/Lima&quot;                    
## [147] &quot;America/Los_Angeles&quot;              &quot;America/Louisville&quot;              
## [149] &quot;America/Lower_Princes&quot;            &quot;America/Maceio&quot;                  
## [151] &quot;America/Managua&quot;                  &quot;America/Manaus&quot;                  
## [153] &quot;America/Marigot&quot;                  &quot;America/Martinique&quot;              
## [155] &quot;America/Matamoros&quot;                &quot;America/Mazatlan&quot;                
## [157] &quot;America/Mendoza&quot;                  &quot;America/Menominee&quot;               
## [159] &quot;America/Merida&quot;                   &quot;America/Metlakatla&quot;              
## [161] &quot;America/Mexico_City&quot;              &quot;America/Miquelon&quot;                
## [163] &quot;America/Moncton&quot;                  &quot;America/Monterrey&quot;               
## [165] &quot;America/Montevideo&quot;               &quot;America/Montreal&quot;                
## [167] &quot;America/Montserrat&quot;               &quot;America/Nassau&quot;                  
## [169] &quot;America/New_York&quot;                 &quot;America/Nipigon&quot;                 
## [171] &quot;America/Nome&quot;                     &quot;America/Noronha&quot;                 
## [173] &quot;America/North_Dakota/Beulah&quot;      &quot;America/North_Dakota/Center&quot;     
## [175] &quot;America/North_Dakota/New_Salem&quot;   &quot;America/Nuuk&quot;                    
## [177] &quot;America/Ojinaga&quot;                  &quot;America/Panama&quot;                  
## [179] &quot;America/Pangnirtung&quot;              &quot;America/Paramaribo&quot;              
## [181] &quot;America/Phoenix&quot;                  &quot;America/Port_of_Spain&quot;           
## [183] &quot;America/Port-au-Prince&quot;           &quot;America/Porto_Acre&quot;              
## [185] &quot;America/Porto_Velho&quot;              &quot;America/Puerto_Rico&quot;             
## [187] &quot;America/Punta_Arenas&quot;             &quot;America/Rainy_River&quot;             
## [189] &quot;America/Rankin_Inlet&quot;             &quot;America/Recife&quot;                  
## [191] &quot;America/Regina&quot;                   &quot;America/Resolute&quot;                
## [193] &quot;America/Rio_Branco&quot;               &quot;America/Rosario&quot;                 
## [195] &quot;America/Santa_Isabel&quot;             &quot;America/Santarem&quot;                
## [197] &quot;America/Santiago&quot;                 &quot;America/Santo_Domingo&quot;           
## [199] &quot;America/Sao_Paulo&quot;                &quot;America/Scoresbysund&quot;            
## [201] &quot;America/Shiprock&quot;                 &quot;America/Sitka&quot;                   
## [203] &quot;America/St_Barthelemy&quot;            &quot;America/St_Johns&quot;                
## [205] &quot;America/St_Kitts&quot;                 &quot;America/St_Lucia&quot;                
## [207] &quot;America/St_Thomas&quot;                &quot;America/St_Vincent&quot;              
## [209] &quot;America/Swift_Current&quot;            &quot;America/Tegucigalpa&quot;             
## [211] &quot;America/Thule&quot;                    &quot;America/Thunder_Bay&quot;             
## [213] &quot;America/Tijuana&quot;                  &quot;America/Toronto&quot;                 
## [215] &quot;America/Tortola&quot;                  &quot;America/Vancouver&quot;               
## [217] &quot;America/Virgin&quot;                   &quot;America/Whitehorse&quot;              
## [219] &quot;America/Winnipeg&quot;                 &quot;America/Yakutat&quot;                 
## [221] &quot;America/Yellowknife&quot;              &quot;Antarctica/Casey&quot;                
## [223] &quot;Antarctica/Davis&quot;                 &quot;Antarctica/DumontDUrville&quot;       
## [225] &quot;Antarctica/Macquarie&quot;             &quot;Antarctica/Mawson&quot;               
## [227] &quot;Antarctica/McMurdo&quot;               &quot;Antarctica/Palmer&quot;               
## [229] &quot;Antarctica/Rothera&quot;               &quot;Antarctica/South_Pole&quot;           
## [231] &quot;Antarctica/Syowa&quot;                 &quot;Antarctica/Troll&quot;                
## [233] &quot;Antarctica/Vostok&quot;                &quot;Arctic/Longyearbyen&quot;             
## [235] &quot;Asia/Aden&quot;                        &quot;Asia/Almaty&quot;                     
## [237] &quot;Asia/Amman&quot;                       &quot;Asia/Anadyr&quot;                     
## [239] &quot;Asia/Aqtau&quot;                       &quot;Asia/Aqtobe&quot;                     
## [241] &quot;Asia/Ashgabat&quot;                    &quot;Asia/Ashkhabad&quot;                  
## [243] &quot;Asia/Atyrau&quot;                      &quot;Asia/Baghdad&quot;                    
## [245] &quot;Asia/Bahrain&quot;                     &quot;Asia/Baku&quot;                       
## [247] &quot;Asia/Bangkok&quot;                     &quot;Asia/Barnaul&quot;                    
## [249] &quot;Asia/Beirut&quot;                      &quot;Asia/Bishkek&quot;                    
## [251] &quot;Asia/Brunei&quot;                      &quot;Asia/Calcutta&quot;                   
## [253] &quot;Asia/Chita&quot;                       &quot;Asia/Choibalsan&quot;                 
## [255] &quot;Asia/Chongqing&quot;                   &quot;Asia/Chungking&quot;                  
## [257] &quot;Asia/Colombo&quot;                     &quot;Asia/Dacca&quot;                      
## [259] &quot;Asia/Damascus&quot;                    &quot;Asia/Dhaka&quot;                      
## [261] &quot;Asia/Dili&quot;                        &quot;Asia/Dubai&quot;                      
## [263] &quot;Asia/Dushanbe&quot;                    &quot;Asia/Famagusta&quot;                  
## [265] &quot;Asia/Gaza&quot;                        &quot;Asia/Harbin&quot;                     
## [267] &quot;Asia/Hebron&quot;                      &quot;Asia/Ho_Chi_Minh&quot;                
## [269] &quot;Asia/Hong_Kong&quot;                   &quot;Asia/Hovd&quot;                       
## [271] &quot;Asia/Irkutsk&quot;                     &quot;Asia/Istanbul&quot;                   
## [273] &quot;Asia/Jakarta&quot;                     &quot;Asia/Jayapura&quot;                   
## [275] &quot;Asia/Jerusalem&quot;                   &quot;Asia/Kabul&quot;                      
## [277] &quot;Asia/Kamchatka&quot;                   &quot;Asia/Karachi&quot;                    
## [279] &quot;Asia/Kashgar&quot;                     &quot;Asia/Kathmandu&quot;                  
## [281] &quot;Asia/Katmandu&quot;                    &quot;Asia/Khandyga&quot;                   
## [283] &quot;Asia/Kolkata&quot;                     &quot;Asia/Krasnoyarsk&quot;                
## [285] &quot;Asia/Kuala_Lumpur&quot;                &quot;Asia/Kuching&quot;                    
## [287] &quot;Asia/Kuwait&quot;                      &quot;Asia/Macao&quot;                      
## [289] &quot;Asia/Macau&quot;                       &quot;Asia/Magadan&quot;                    
## [291] &quot;Asia/Makassar&quot;                    &quot;Asia/Manila&quot;                     
## [293] &quot;Asia/Muscat&quot;                      &quot;Asia/Nicosia&quot;                    
## [295] &quot;Asia/Novokuznetsk&quot;                &quot;Asia/Novosibirsk&quot;                
## [297] &quot;Asia/Omsk&quot;                        &quot;Asia/Oral&quot;                       
## [299] &quot;Asia/Phnom_Penh&quot;                  &quot;Asia/Pontianak&quot;                  
## [301] &quot;Asia/Pyongyang&quot;                   &quot;Asia/Qatar&quot;                      
## [303] &quot;Asia/Qostanay&quot;                    &quot;Asia/Qyzylorda&quot;                  
## [305] &quot;Asia/Rangoon&quot;                     &quot;Asia/Riyadh&quot;                     
## [307] &quot;Asia/Saigon&quot;                      &quot;Asia/Sakhalin&quot;                   
## [309] &quot;Asia/Samarkand&quot;                   &quot;Asia/Seoul&quot;                      
## [311] &quot;Asia/Shanghai&quot;                    &quot;Asia/Singapore&quot;                  
## [313] &quot;Asia/Srednekolymsk&quot;               &quot;Asia/Taipei&quot;                     
## [315] &quot;Asia/Tashkent&quot;                    &quot;Asia/Tbilisi&quot;                    
## [317] &quot;Asia/Tehran&quot;                      &quot;Asia/Tel_Aviv&quot;                   
## [319] &quot;Asia/Thimbu&quot;                      &quot;Asia/Thimphu&quot;                    
## [321] &quot;Asia/Tokyo&quot;                       &quot;Asia/Tomsk&quot;                      
## [323] &quot;Asia/Ujung_Pandang&quot;               &quot;Asia/Ulaanbaatar&quot;                
## [325] &quot;Asia/Ulan_Bator&quot;                  &quot;Asia/Urumqi&quot;                     
## [327] &quot;Asia/Ust-Nera&quot;                    &quot;Asia/Vientiane&quot;                  
## [329] &quot;Asia/Vladivostok&quot;                 &quot;Asia/Yakutsk&quot;                    
## [331] &quot;Asia/Yangon&quot;                      &quot;Asia/Yekaterinburg&quot;              
## [333] &quot;Asia/Yerevan&quot;                     &quot;Atlantic/Azores&quot;                 
## [335] &quot;Atlantic/Bermuda&quot;                 &quot;Atlantic/Canary&quot;                 
## [337] &quot;Atlantic/Cape_Verde&quot;              &quot;Atlantic/Faeroe&quot;                 
## [339] &quot;Atlantic/Faroe&quot;                   &quot;Atlantic/Jan_Mayen&quot;              
## [341] &quot;Atlantic/Madeira&quot;                 &quot;Atlantic/Reykjavik&quot;              
## [343] &quot;Atlantic/South_Georgia&quot;           &quot;Atlantic/St_Helena&quot;              
## [345] &quot;Atlantic/Stanley&quot;                 &quot;Australia/ACT&quot;                   
## [347] &quot;Australia/Adelaide&quot;               &quot;Australia/Brisbane&quot;              
## [349] &quot;Australia/Broken_Hill&quot;            &quot;Australia/Canberra&quot;              
## [351] &quot;Australia/Currie&quot;                 &quot;Australia/Darwin&quot;                
## [353] &quot;Australia/Eucla&quot;                  &quot;Australia/Hobart&quot;                
## [355] &quot;Australia/LHI&quot;                    &quot;Australia/Lindeman&quot;              
## [357] &quot;Australia/Lord_Howe&quot;              &quot;Australia/Melbourne&quot;             
## [359] &quot;Australia/North&quot;                  &quot;Australia/NSW&quot;                   
## [361] &quot;Australia/Perth&quot;                  &quot;Australia/Queensland&quot;            
## [363] &quot;Australia/South&quot;                  &quot;Australia/Sydney&quot;                
## [365] &quot;Australia/Tasmania&quot;               &quot;Australia/Victoria&quot;              
## [367] &quot;Australia/West&quot;                   &quot;Australia/Yancowinna&quot;            
## [369] &quot;Brazil/Acre&quot;                      &quot;Brazil/DeNoronha&quot;                
## [371] &quot;Brazil/East&quot;                      &quot;Brazil/West&quot;                     
## [373] &quot;Canada/Atlantic&quot;                  &quot;Canada/Central&quot;                  
## [375] &quot;Canada/Eastern&quot;                   &quot;Canada/Mountain&quot;                 
## [377] &quot;Canada/Newfoundland&quot;              &quot;Canada/Pacific&quot;                  
## [379] &quot;Canada/Saskatchewan&quot;              &quot;Canada/Yukon&quot;                    
## [381] &quot;CET&quot;                              &quot;Chile/Continental&quot;               
## [383] &quot;Chile/EasterIsland&quot;               &quot;CST6CDT&quot;                         
## [385] &quot;Cuba&quot;                             &quot;EET&quot;                             
## [387] &quot;Egypt&quot;                            &quot;Eire&quot;                            
## [389] &quot;EST&quot;                              &quot;EST5EDT&quot;                         
## [391] &quot;Etc/GMT&quot;                          &quot;Etc/GMT-0&quot;                       
## [393] &quot;Etc/GMT-1&quot;                        &quot;Etc/GMT-10&quot;                      
## [395] &quot;Etc/GMT-11&quot;                       &quot;Etc/GMT-12&quot;                      
## [397] &quot;Etc/GMT-13&quot;                       &quot;Etc/GMT-14&quot;                      
## [399] &quot;Etc/GMT-2&quot;                        &quot;Etc/GMT-3&quot;                       
## [401] &quot;Etc/GMT-4&quot;                        &quot;Etc/GMT-5&quot;                       
## [403] &quot;Etc/GMT-6&quot;                        &quot;Etc/GMT-7&quot;                       
## [405] &quot;Etc/GMT-8&quot;                        &quot;Etc/GMT-9&quot;                       
## [407] &quot;Etc/GMT+0&quot;                        &quot;Etc/GMT+1&quot;                       
## [409] &quot;Etc/GMT+10&quot;                       &quot;Etc/GMT+11&quot;                      
## [411] &quot;Etc/GMT+12&quot;                       &quot;Etc/GMT+2&quot;                       
## [413] &quot;Etc/GMT+3&quot;                        &quot;Etc/GMT+4&quot;                       
## [415] &quot;Etc/GMT+5&quot;                        &quot;Etc/GMT+6&quot;                       
## [417] &quot;Etc/GMT+7&quot;                        &quot;Etc/GMT+8&quot;                       
## [419] &quot;Etc/GMT+9&quot;                        &quot;Etc/GMT0&quot;                        
## [421] &quot;Etc/Greenwich&quot;                    &quot;Etc/UCT&quot;                         
## [423] &quot;Etc/Universal&quot;                    &quot;Etc/UTC&quot;                         
## [425] &quot;Etc/Zulu&quot;                         &quot;Europe/Amsterdam&quot;                
## [427] &quot;Europe/Andorra&quot;                   &quot;Europe/Astrakhan&quot;                
## [429] &quot;Europe/Athens&quot;                    &quot;Europe/Belfast&quot;                  
## [431] &quot;Europe/Belgrade&quot;                  &quot;Europe/Berlin&quot;                   
## [433] &quot;Europe/Bratislava&quot;                &quot;Europe/Brussels&quot;                 
## [435] &quot;Europe/Bucharest&quot;                 &quot;Europe/Budapest&quot;                 
## [437] &quot;Europe/Busingen&quot;                  &quot;Europe/Chisinau&quot;                 
## [439] &quot;Europe/Copenhagen&quot;                &quot;Europe/Dublin&quot;                   
## [441] &quot;Europe/Gibraltar&quot;                 &quot;Europe/Guernsey&quot;                 
## [443] &quot;Europe/Helsinki&quot;                  &quot;Europe/Isle_of_Man&quot;              
## [445] &quot;Europe/Istanbul&quot;                  &quot;Europe/Jersey&quot;                   
## [447] &quot;Europe/Kaliningrad&quot;               &quot;Europe/Kiev&quot;                     
## [449] &quot;Europe/Kirov&quot;                     &quot;Europe/Lisbon&quot;                   
## [451] &quot;Europe/Ljubljana&quot;                 &quot;Europe/London&quot;                   
## [453] &quot;Europe/Luxembourg&quot;                &quot;Europe/Madrid&quot;                   
## [455] &quot;Europe/Malta&quot;                     &quot;Europe/Mariehamn&quot;                
## [457] &quot;Europe/Minsk&quot;                     &quot;Europe/Monaco&quot;                   
## [459] &quot;Europe/Moscow&quot;                    &quot;Europe/Nicosia&quot;                  
## [461] &quot;Europe/Oslo&quot;                      &quot;Europe/Paris&quot;                    
## [463] &quot;Europe/Podgorica&quot;                 &quot;Europe/Prague&quot;                   
## [465] &quot;Europe/Riga&quot;                      &quot;Europe/Rome&quot;                     
## [467] &quot;Europe/Samara&quot;                    &quot;Europe/San_Marino&quot;               
## [469] &quot;Europe/Sarajevo&quot;                  &quot;Europe/Saratov&quot;                  
## [471] &quot;Europe/Simferopol&quot;                &quot;Europe/Skopje&quot;                   
## [473] &quot;Europe/Sofia&quot;                     &quot;Europe/Stockholm&quot;                
## [475] &quot;Europe/Tallinn&quot;                   &quot;Europe/Tirane&quot;                   
## [477] &quot;Europe/Tiraspol&quot;                  &quot;Europe/Ulyanovsk&quot;                
## [479] &quot;Europe/Uzhgorod&quot;                  &quot;Europe/Vaduz&quot;                    
## [481] &quot;Europe/Vatican&quot;                   &quot;Europe/Vienna&quot;                   
## [483] &quot;Europe/Vilnius&quot;                   &quot;Europe/Volgograd&quot;                
## [485] &quot;Europe/Warsaw&quot;                    &quot;Europe/Zagreb&quot;                   
## [487] &quot;Europe/Zaporozhye&quot;                &quot;Europe/Zurich&quot;                   
## [489] &quot;Factory&quot;                          &quot;GB&quot;                              
## [491] &quot;GB-Eire&quot;                          &quot;GMT&quot;                             
## [493] &quot;GMT-0&quot;                            &quot;GMT+0&quot;                           
## [495] &quot;GMT0&quot;                             &quot;Greenwich&quot;                       
## [497] &quot;Hongkong&quot;                         &quot;HST&quot;                             
## [499] &quot;Iceland&quot;                          &quot;Indian/Antananarivo&quot;             
## [501] &quot;Indian/Chagos&quot;                    &quot;Indian/Christmas&quot;                
## [503] &quot;Indian/Cocos&quot;                     &quot;Indian/Comoro&quot;                   
## [505] &quot;Indian/Kerguelen&quot;                 &quot;Indian/Mahe&quot;                     
## [507] &quot;Indian/Maldives&quot;                  &quot;Indian/Mauritius&quot;                
## [509] &quot;Indian/Mayotte&quot;                   &quot;Indian/Reunion&quot;                  
## [511] &quot;Iran&quot;                             &quot;Israel&quot;                          
## [513] &quot;Jamaica&quot;                          &quot;Japan&quot;                           
## [515] &quot;Kwajalein&quot;                        &quot;Libya&quot;                           
## [517] &quot;MET&quot;                              &quot;Mexico/BajaNorte&quot;                
## [519] &quot;Mexico/BajaSur&quot;                   &quot;Mexico/General&quot;                  
## [521] &quot;MST&quot;                              &quot;MST7MDT&quot;                         
## [523] &quot;Navajo&quot;                           &quot;NZ&quot;                              
## [525] &quot;NZ-CHAT&quot;                          &quot;Pacific/Apia&quot;                    
## [527] &quot;Pacific/Auckland&quot;                 &quot;Pacific/Bougainville&quot;            
## [529] &quot;Pacific/Chatham&quot;                  &quot;Pacific/Chuuk&quot;                   
## [531] &quot;Pacific/Easter&quot;                   &quot;Pacific/Efate&quot;                   
## [533] &quot;Pacific/Enderbury&quot;                &quot;Pacific/Fakaofo&quot;                 
## [535] &quot;Pacific/Fiji&quot;                     &quot;Pacific/Funafuti&quot;                
## [537] &quot;Pacific/Galapagos&quot;                &quot;Pacific/Gambier&quot;                 
## [539] &quot;Pacific/Guadalcanal&quot;              &quot;Pacific/Guam&quot;                    
## [541] &quot;Pacific/Honolulu&quot;                 &quot;Pacific/Johnston&quot;                
## [543] &quot;Pacific/Kanton&quot;                   &quot;Pacific/Kiritimati&quot;              
## [545] &quot;Pacific/Kosrae&quot;                   &quot;Pacific/Kwajalein&quot;               
## [547] &quot;Pacific/Majuro&quot;                   &quot;Pacific/Marquesas&quot;               
## [549] &quot;Pacific/Midway&quot;                   &quot;Pacific/Nauru&quot;                   
## [551] &quot;Pacific/Niue&quot;                     &quot;Pacific/Norfolk&quot;                 
## [553] &quot;Pacific/Noumea&quot;                   &quot;Pacific/Pago_Pago&quot;               
## [555] &quot;Pacific/Palau&quot;                    &quot;Pacific/Pitcairn&quot;                
## [557] &quot;Pacific/Pohnpei&quot;                  &quot;Pacific/Ponape&quot;                  
## [559] &quot;Pacific/Port_Moresby&quot;             &quot;Pacific/Rarotonga&quot;               
## [561] &quot;Pacific/Saipan&quot;                   &quot;Pacific/Samoa&quot;                   
## [563] &quot;Pacific/Tahiti&quot;                   &quot;Pacific/Tarawa&quot;                  
## [565] &quot;Pacific/Tongatapu&quot;                &quot;Pacific/Truk&quot;                    
## [567] &quot;Pacific/Wake&quot;                     &quot;Pacific/Wallis&quot;                  
## [569] &quot;Pacific/Yap&quot;                      &quot;Poland&quot;                          
## [571] &quot;Portugal&quot;                         &quot;PRC&quot;                             
## [573] &quot;PST8PDT&quot;                          &quot;ROC&quot;                             
## [575] &quot;ROK&quot;                              &quot;Singapore&quot;                       
## [577] &quot;Turkey&quot;                           &quot;UCT&quot;                             
## [579] &quot;Universal&quot;                        &quot;US/Alaska&quot;                       
## [581] &quot;US/Aleutian&quot;                      &quot;US/Arizona&quot;                      
## [583] &quot;US/Central&quot;                       &quot;US/East-Indiana&quot;                 
## [585] &quot;US/Eastern&quot;                       &quot;US/Hawaii&quot;                       
## [587] &quot;US/Indiana-Starke&quot;                &quot;US/Michigan&quot;                     
## [589] &quot;US/Mountain&quot;                      &quot;US/Pacific&quot;                      
## [591] &quot;US/Samoa&quot;                         &quot;UTC&quot;                             
## [593] &quot;W-SU&quot;                             &quot;WET&quot;                             
## [595] &quot;Zulu&quot;                            
## attr(,&quot;Version&quot;)
## [1] &quot;2022a&quot;</code></pre>
</div>
<div id="时区-1" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> 时区<a href="04-lubridate.html#时区-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="04-lubridate.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="fu">now</span>(), <span class="at">tz =</span> <span class="st">&quot;PRC&quot;</span>) <span class="co">#将时间信息的时区设置为中国</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07 08:02:31 CST&quot;</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="04-lubridate.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with_tz</span>(<span class="fu">now</span>(), <span class="at">tz=</span><span class="st">&quot;Europe/Berlin&quot;</span>) <span class="co">#查看其他时区对应的时间，例如柏林</span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07 02:02:31 CEST&quot;</code></pre>
</div>
<div id="时间计算" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> 时间计算<a href="04-lubridate.html#时间计算" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="04-lubridate.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">now</span>() <span class="co">#现在时间 </span></span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07 08:02:31 CST&quot;</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="04-lubridate.html#cb409-1" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">today</span>(), <span class="st">&quot;23:59:59&quot;</span>) <span class="co">#今天的最后1秒</span></span>
<span id="cb409-2"><a href="04-lubridate.html#cb409-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(end) <span class="co">#是字符串，不是时间格式</span></span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="04-lubridate.html#cb411-1" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(end) <span class="co">#转化为时间格式</span></span>
<span id="cb411-2"><a href="04-lubridate.html#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co">#今天还剩下多少时间  </span></span>
<span id="cb411-3"><a href="04-lubridate.html#cb411-3" aria-hidden="true" tabindex="-1"></a>end <span class="sc">-</span> <span class="fu">now</span>() <span class="co"># 计算两点间的时间长度；有误，时区不同导致</span></span></code></pre></div>
<pre><code>## Time difference of 23.95768 hours</code></pre>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="04-lubridate.html#cb413-1" aria-hidden="true" tabindex="-1"></a>end <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(end, <span class="at">tz=</span><span class="st">&quot;PRC&quot;</span>) <span class="co">#时区设置为中国</span></span>
<span id="cb413-2"><a href="04-lubridate.html#cb413-2" aria-hidden="true" tabindex="-1"></a>end <span class="sc">-</span> <span class="fu">now</span>() <span class="co">#计算两点间的时间长度；正确</span></span></code></pre></div>
<pre><code>## Time difference of 15.95768 hours</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="04-lubridate.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">difftime</span>(end, <span class="fu">now</span>()) <span class="co">#另一种方法，计算两点间的时间长度</span></span></code></pre></div>
<pre><code>## Time difference of 15.95768 hours</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="04-lubridate.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">today</span>()<span class="sc">-</span><span class="fu">ymd</span>(<span class="dv">19820704</span>) <span class="co">#我出生多少天了</span></span></code></pre></div>
<pre><code>## Time difference of 14583 days</code></pre>
</div>
<div id="时间数据可视化" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> 时间数据可视化<a href="04-lubridate.html#时间数据可视化" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="厦门空气质量数据分析" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> 厦门空气质量数据分析<a href="04-lubridate.html#厦门空气质量数据分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>数据来源：<a href="https://quotsoft.net/air/" class="uri">https://quotsoft.net/air/</a><br />
已下载并整理出厦门2018-2021四年的空气质量数据（csv格式）。</p>
<p><strong>读取并查看数据：</strong></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="04-lubridate.html#cb419-1" aria-hidden="true" tabindex="-1"></a>d2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/xiamen air/xiamen_air_2021.csv&quot;</span>) <span class="co">#读取2021年的数据</span></span>
<span id="cb419-2"><a href="04-lubridate.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d2021) <span class="co">#包含PM2.5，PM10，NO2，SO2， O3， CO等污染物，以及日期、小时、AQI等信息</span></span></code></pre></div>
<pre><code>##  [1] &quot;X&quot;         &quot;hour&quot;      &quot;AQI&quot;       &quot;PM2.5&quot;     &quot;PM2.5_24h&quot; &quot;PM10&quot;     
##  [7] &quot;PM10_24h&quot;  &quot;SO2&quot;       &quot;SO2_24h&quot;   &quot;NO2&quot;       &quot;NO2_24h&quot;   &quot;O3&quot;       
## [13] &quot;O3_24h&quot;    &quot;O3_8h&quot;     &quot;O3_8h_24h&quot; &quot;CO&quot;        &quot;CO_24h&quot;    &quot;date&quot;</code></pre>
</div>
<div id="年厦门pm2.5逐日变化趋势" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> 2021年厦门PM2.5逐日变化趋势<a href="04-lubridate.html#年厦门pm2.5逐日变化趋势" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="04-lubridate.html#cb421-1" aria-hidden="true" tabindex="-1"></a>d2021 <span class="sc">%&gt;%</span></span>
<span id="cb421-2"><a href="04-lubridate.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ymd</span>(date)) <span class="sc">%&gt;%</span>  <span class="co">#将date转化为日期格式（原为字符格式）</span></span>
<span id="cb421-3"><a href="04-lubridate.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, PM2<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb421-4"><a href="04-lubridate.html#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span> <span class="co">#所有点，每个小时1个点</span></span>
<span id="cb421-5"><a href="04-lubridate.html#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="co">#日均值线</span></span></code></pre></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
</div>
<div id="年厦门pm2.5逐日变化趋势调整细节" class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> 2021年厦门PM2.5逐日变化趋势：调整细节<a href="04-lubridate.html#年厦门pm2.5逐日变化趋势调整细节" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="04-lubridate.html#cb424-1" aria-hidden="true" tabindex="-1"></a>d2021 <span class="sc">%&gt;%</span></span>
<span id="cb424-2"><a href="04-lubridate.html#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ymd</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb424-3"><a href="04-lubridate.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(date, PM2<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb424-4"><a href="04-lubridate.html#cb424-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb424-5"><a href="04-lubridate.html#cb424-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.3</span>, <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb424-6"><a href="04-lubridate.html#cb424-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">&quot;line&quot;</span>, <span class="at">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="at">color=</span><span class="st">&quot;red2&quot;</span>)<span class="sc">+</span> </span>
<span id="cb424-7"><a href="04-lubridate.html#cb424-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">&quot;%m/%d&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;1 month&quot;</span>)<span class="sc">+</span> </span>
<span id="cb424-8"><a href="04-lubridate.html#cb424-8" aria-hidden="true" tabindex="-1"></a><span class="co">#x轴时间格式设置，格式设置更多选择，查看?strptime(见下下页)</span></span>
<span id="cb424-9"><a href="04-lubridate.html#cb424-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb424-10"><a href="04-lubridate.html#cb424-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="sc">~</span>PM[<span class="fl">2.5</span>]<span class="sc">~</span><span class="st">&#39;(&#39;</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>m<span class="sc">^</span><span class="st">&#39;-3&#39;</span><span class="sc">*</span><span class="st">&#39;)&#39;</span>,</span>
<span id="cb424-11"><a href="04-lubridate.html#cb424-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Xiamen, 2021&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>## Warning: Removed 7 rows containing missing values (geom_point).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
</div>
<div id="strptime查看日期时间格式" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> <code>?strptime</code>查看日期时间格式<a href="04-lubridate.html#strptime查看日期时间格式" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>以下摘录部分，替换进.red[<code>scale_x_date(date_labels = "%x")</code>]试试以下代码的效果：</p>
<p>%b
Abbreviated month name in the current locale on this platform. (Also matches full name on input: in some locales there are no abbreviations of names.) .red[月份文字缩写]</p>
<p>%B
Full month name in the current locale. (Also matches abbreviated name on input.) .red[月份文字全称]</p>
<p>%d
Day of the month as decimal number (01–31).</p>
<p>%D
Date format such as %m/%d/%y: the C99 standard says it should be that exact format (but not all OSes comply). .red[MM/DD/YY格式]</p>
<p>%F
Equivalent to %Y-%m-%d (the ISO 8601 date format).</p>
<p>%m
Month as decimal number (01–12). .red[月份，两位数表示]</p>
<p>%x
Date. Locale-specific on output, “%y/%m/%d” on input.</p>
<p>查看<code>?strptime</code>页面信息或上一页节选信息，尝试各种格式</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="04-lubridate.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%Y-%B-%d&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-June-07&quot;</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="04-lubridate.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%Y/%b/%d&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022/Jun/07&quot;</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="04-lubridate.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%x&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;06/07/2022&quot;</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="04-lubridate.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%F&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-06-07&quot;</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="04-lubridate.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%m-%d&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;06-07&quot;</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="04-lubridate.html#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(<span class="fu">today</span>(), <span class="at">format =</span> <span class="st">&quot;%D&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;06/07/22&quot;</code></pre>
</div>
<div id="合并四年数据用于分析" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> 合并四年数据用于分析<a href="04-lubridate.html#合并四年数据用于分析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="04-lubridate.html#cb439-1" aria-hidden="true" tabindex="-1"></a>d2018 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/xiamen air/xiamen_air_2018.csv&quot;</span>)</span>
<span id="cb439-2"><a href="04-lubridate.html#cb439-2" aria-hidden="true" tabindex="-1"></a>d2019 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/xiamen air/xiamen_air_2019.csv&quot;</span>)</span>
<span id="cb439-3"><a href="04-lubridate.html#cb439-3" aria-hidden="true" tabindex="-1"></a>d2020 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/xiamen air/xiamen_air_2020.csv&quot;</span>)</span>
<span id="cb439-4"><a href="04-lubridate.html#cb439-4" aria-hidden="true" tabindex="-1"></a>d2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/xiamen air/xiamen_air_2021.csv&quot;</span>)</span>
<span id="cb439-5"><a href="04-lubridate.html#cb439-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-6"><a href="04-lubridate.html#cb439-6" aria-hidden="true" tabindex="-1"></a>d0 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(d2018, d2019, d2020, d2021)</span>
<span id="cb439-7"><a href="04-lubridate.html#cb439-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d0) <span class="co">#34330条数据；(4年应该有365.25*24*4 = 35064条，说明缺失几天数据）</span></span></code></pre></div>
<pre><code>## [1] 34330    18</code></pre>
<div id="了解合并数据的结构尤其是数据类型" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> 了解合并数据的结构，尤其是数据类型<a href="04-lubridate.html#了解合并数据的结构尤其是数据类型" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="04-lubridate.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d0)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    34330 obs. of  18 variables:
##  $ X        : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ hour     : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ AQI      : int  81 84 87 NA NA NA NA NA NA NA ...
##  $ PM2.5    : int  53 54 59 NA NA NA NA NA NA NA ...
##  $ PM2.5_24h: int  45 46 47 NA NA NA NA NA NA NA ...
##  $ PM10     : int  111 117 123 NA NA NA NA NA NA NA ...
##  $ PM10_24h : int  83 85 88 NA NA NA NA NA NA NA ...
##  $ SO2      : int  14 14 15 NA NA NA NA NA NA NA ...
##  $ SO2_24h  : int  12 13 13 NA NA NA NA NA NA NA ...
##  $ NO2      : int  21 20 18 NA NA NA NA NA NA NA ...
##  $ NO2_24h  : int  32 31 31 NA NA NA NA NA NA NA ...
##  $ O3       : int  78 83 90 NA NA NA NA NA NA NA ...
##  $ O3_24h   : int  78 83 90 NA NA NA NA NA NA NA ...
##  $ O3_8h    : int  67 83 86 NA NA NA NA NA NA NA ...
##  $ O3_8h_24h: int  67 83 86 NA NA NA NA NA NA NA ...
##  $ CO       : num  0.83 0.8 0.77 NA NA NA NA NA NA NA ...
##  $ CO_24h   : num  0.77 0.77 0.77 NA NA NA NA NA NA NA ...
##  $ date     : int  20180101 20180101 20180101 20180101 20180101 20180101 20180101 20180101 20180101 20180101 ...</code></pre>
</div>
</div>
<div id="数据整理" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> 数据整理<a href="04-lubridate.html#数据整理" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>目前存在问题：（1）<code>date</code>还不是日期格式；（2）没有完整的日期时间列</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="04-lubridate.html#cb443-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d0 <span class="sc">%&gt;%</span> </span>
<span id="cb443-2"><a href="04-lubridate.html#cb443-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_ymdh =</span> <span class="fu">ymd_h</span>(<span class="fu">paste</span>(date, hour))) <span class="co">#用ymd_h生成“年月日时”列</span></span>
<span id="cb443-3"><a href="04-lubridate.html#cb443-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-4"><a href="04-lubridate.html#cb443-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(d<span class="sc">$</span>time_ymdh, <span class="dv">10</span>) <span class="co">#随机选10个查看，确认已是时间格式</span></span></code></pre></div>
<pre><code>##  [1] &quot;2020-04-20 03:00:00 UTC&quot; &quot;2019-10-13 13:00:00 UTC&quot;
##  [3] &quot;2018-03-30 20:00:00 UTC&quot; &quot;2018-01-22 02:00:00 UTC&quot;
##  [5] &quot;2019-06-04 03:00:00 UTC&quot; &quot;2020-02-13 16:00:00 UTC&quot;
##  [7] &quot;2019-09-16 06:00:00 UTC&quot; &quot;2021-12-06 17:00:00 UTC&quot;
##  [9] &quot;2018-03-17 02:00:00 UTC&quot; &quot;2019-05-10 02:00:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="04-lubridate.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(d<span class="sc">$</span>time_ymdh) <span class="co">#查看格式，确认是时间格式</span></span></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p>POSIXct = Portable Operating System Interface for Unix calendar time</p>
<p>Portable Operating System Interface for Unix calendar time</p>
</div>
<div id="缺哪天的数据" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> 缺哪天的数据？<a href="04-lubridate.html#缺哪天的数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>用数据可视化的方式，快速找出缺失数据的位置</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="04-lubridate.html#cb447-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb447-2"><a href="04-lubridate.html#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time_ymdh), <span class="co">#生成年列</span></span>
<span id="cb447-3"><a href="04-lubridate.html#cb447-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(time_ymdh), <span class="co">#生成月份列</span></span>
<span id="cb447-4"><a href="04-lubridate.html#cb447-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(time_ymdh)) <span class="sc">%&gt;%</span>  <span class="co">#生成日列</span></span>
<span id="cb447-5"><a href="04-lubridate.html#cb447-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> month, <span class="at">z =</span> PM2<span class="fl">.5</span>))<span class="sc">+</span></span>
<span id="cb447-6"><a href="04-lubridate.html#cb447-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span> <span class="co">#作栅格图，找到缺失格</span></span>
<span id="cb447-7"><a href="04-lubridate.html#cb447-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)<span class="sc">+</span></span>
<span id="cb447-8"><a href="04-lubridate.html#cb447-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>)<span class="sc">+</span></span>
<span id="cb447-9"><a href="04-lubridate.html#cb447-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb447-10"><a href="04-lubridate.html#cb447-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
<p>缺2018年12月22-26日和2019年8月24日数据。<br />
可从其他渠道获取数据，将缺失数据补齐。我们暂且忽略缺失数据，继续分析。</p>
</div>
<div id="总体趋势厦门aqi的4年趋势" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> 总体趋势：厦门AQI的4年趋势<a href="04-lubridate.html#总体趋势厦门aqi的4年趋势" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="04-lubridate.html#cb448-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb448-2"><a href="04-lubridate.html#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_ymdh, AQI))<span class="sc">+</span> <span class="co">#time_ymdh是日期时间格式，可作为x变量</span></span>
<span id="cb448-3"><a href="04-lubridate.html#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb448-4"><a href="04-lubridate.html#cb448-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F) <span class="co">#去除置信区间阴影</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>## Warning: Removed 165 rows containing non-finite values (stat_smooth).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<p>总体稳定在50上下，能看到明显的季节波动，空气质量优的天数在增加，污染的天数明显减少。<br />
注：AQI = 0-50是优，51-100是良，101-150是轻度污染，151-200是中度污染，201-300是重度污染，300+是严重污染</p>
</div>
<div id="总体趋势一并查看6项指标" class="section level2 hasAnchor" number="3.13">
<h2><span class="header-section-number">3.13</span> 总体趋势：一并查看6项指标<a href="04-lubridate.html#总体趋势一并查看6项指标" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="04-lubridate.html#cb451-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb451-2"><a href="04-lubridate.html#cb451-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_ymdh, PM2<span class="fl">.5</span>, PM10, SO2, NO2, O3, CO) <span class="sc">%&gt;%</span>  <span class="co">#选出6项指标</span></span>
<span id="cb451-3"><a href="04-lubridate.html#cb451-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">names_to =</span> <span class="st">&quot;parameter&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co">#将宽表格转为长表格，要转的数据在2-7列</span></span>
<span id="cb451-4"><a href="04-lubridate.html#cb451-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_ymdh, value))<span class="sc">+</span></span>
<span id="cb451-5"><a href="04-lubridate.html#cb451-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb451-6"><a href="04-lubridate.html#cb451-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales=</span><span class="st">&quot;free_y&quot;</span>)<span class="sc">+</span></span>
<span id="cb451-7"><a href="04-lubridate.html#cb451-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>## Warning: Removed 1055 rows containing non-finite values (stat_smooth).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
<p>（1）CO、NO2、PM10、PM2.5、SO2浓度总体下降，极端值频率降低；（2）O3总体稳定；（3）季节波动明显</p>
</div>
<div id="细看季节趋势pm2.5" class="section level2 hasAnchor" number="3.14">
<h2><span class="header-section-number">3.14</span> 细看季节趋势：PM2.5<a href="04-lubridate.html#细看季节趋势pm2.5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>将4年数据分开看，计算每日PM2.5均值，查看PM2.5均值在一年中的逐日变化趋势。</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="04-lubridate.html#cb454-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb454-2"><a href="04-lubridate.html#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time_ymdh), <span class="co">#新增列：年份</span></span>
<span id="cb454-3"><a href="04-lubridate.html#cb454-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_d =</span> <span class="fu">yday</span>(time_ymdh)) <span class="sc">%&gt;%</span> <span class="co">#新增列：一年中的第几天</span></span>
<span id="cb454-4"><a href="04-lubridate.html#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, time_d) <span class="sc">%&gt;%</span>  <span class="co">#按某年的某日分组</span></span>
<span id="cb454-5"><a href="04-lubridate.html#cb454-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PM2<span class="fl">.5</span>, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span>  <span class="co">#计算PM2.5均值，注意去除缺失值</span></span>
<span id="cb454-6"><a href="04-lubridate.html#cb454-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_d, mean, <span class="at">color=</span><span class="fu">factor</span>(year)))<span class="sc">+</span></span>
<span id="cb454-7"><a href="04-lubridate.html#cb454-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb454-8"><a href="04-lubridate.html#cb454-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)<span class="sc">+</span></span>
<span id="cb454-9"><a href="04-lubridate.html#cb454-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb454-10"><a href="04-lubridate.html#cb454-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">&quot;none&quot;</span>) <span class="co">#去除多余的颜色图例</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;. You can override using the
## `.groups` argument.
## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<p>可以看到：PM2.5在冬春季节较高，夏秋季节较低，第200天左右（即7月份）达到最低值。</p>
<p>尝试一下：把PM2.5换成其他参数</p>
</div>
<div id="细看各个月份各月份的pm2.5概率密度分布" class="section level2 hasAnchor" number="3.15">
<h2><span class="header-section-number">3.15</span> 细看各个月份：各月份的PM2.5概率密度分布<a href="04-lubridate.html#细看各个月份各月份的pm2.5概率密度分布" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="04-lubridate.html#cb456-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb456-2"><a href="04-lubridate.html#cb456-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month=</span><span class="fu">month</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb456-3"><a href="04-lubridate.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>PM2<span class="fl">.5</span>))<span class="sc">+</span></span>
<span id="cb456-4"><a href="04-lubridate.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb456-5"><a href="04-lubridate.html#cb456-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(month))) <span class="co">#概率密度图，颜色映射到月份</span></span></code></pre></div>
<pre><code>## Warning: Removed 166 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<p>各月份有明显区别，但混在一起，较难分辨</p>
</div>
<div id="对比各月份与总体的pm2.5概率密度分布" class="section level2 hasAnchor" number="3.16">
<h2><span class="header-section-number">3.16</span> 对比各月份与总体的PM2.5概率密度分布<a href="04-lubridate.html#对比各月份与总体的pm2.5概率密度分布" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="04-lubridate.html#cb458-1" aria-hidden="true" tabindex="-1"></a>label_month <span class="ot">&lt;-</span> month.name <span class="co"># month.name是12个月份的名称，敲一下看看</span></span>
<span id="cb458-2"><a href="04-lubridate.html#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(label_month) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="co">#用于将1-12月修改为January-December</span></span>
<span id="cb458-3"><a href="04-lubridate.html#cb458-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-4"><a href="04-lubridate.html#cb458-4" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb458-5"><a href="04-lubridate.html#cb458-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month=</span><span class="fu">month</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb458-6"><a href="04-lubridate.html#cb458-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>PM2<span class="fl">.5</span>))<span class="sc">+</span></span>
<span id="cb458-7"><a href="04-lubridate.html#cb458-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb458-8"><a href="04-lubridate.html#cb458-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>month,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">month =</span> label_month))<span class="sc">+</span></span>
<span id="cb458-9"><a href="04-lubridate.html#cb458-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data=</span>d, <span class="at">fill=</span><span class="st">&quot;grey80&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span> <span class="co">#所有月份的数据（d中不含month列，不会被分面）</span></span>
<span id="cb458-10"><a href="04-lubridate.html#cb458-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">&quot;red&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span> <span class="co">#单独各个月份的数据（含month列，会被分面）</span></span>
<span id="cb458-11"><a href="04-lubridate.html#cb458-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="sc">~</span>PM[<span class="fl">2.5</span>]<span class="sc">~</span><span class="st">&#39;(&#39;</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>m<span class="sc">^</span><span class="st">&#39;-3&#39;</span><span class="sc">*</span><span class="st">&#39;)&#39;</span>,</span>
<span id="cb458-12"><a href="04-lubridate.html#cb458-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Probability density&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1992 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning: Removed 166 rows containing non-finite values (stat_density).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
</div>
<div id="对比各月份与总体的pm2.5概率密度分布-1" class="section level2 hasAnchor" number="3.17">
<h2><span class="header-section-number">3.17</span> 对比各月份与总体的PM2.5概率密度分布<a href="04-lubridate.html#对比各月份与总体的pm2.5概率密度分布-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>PM2.5浓度概率密度分布：黑色是总体的分布，红色是各个月份的分布<br />
往右拖尾表示污染升高，可以看到6-8月PM2.5明显低于总体均值</p>
</div>
<div id="季节趋势总览全部参数" class="section level2 hasAnchor" number="3.18">
<h2><span class="header-section-number">3.18</span> 季节趋势：总览全部参数<a href="04-lubridate.html#季节趋势总览全部参数" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="04-lubridate.html#cb461-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb461-2"><a href="04-lubridate.html#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_ymdh, PM2<span class="fl">.5</span>, PM10, SO2, NO2, O3, CO) <span class="sc">%&gt;%</span> </span>
<span id="cb461-3"><a href="04-lubridate.html#cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time_ymdh),</span>
<span id="cb461-4"><a href="04-lubridate.html#cb461-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_d =</span> <span class="fu">yday</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb461-5"><a href="04-lubridate.html#cb461-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">names_to =</span> <span class="st">&quot;parameter&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb461-6"><a href="04-lubridate.html#cb461-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_d, value, <span class="at">color=</span><span class="fu">factor</span>(year)))<span class="sc">+</span></span>
<span id="cb461-7"><a href="04-lubridate.html#cb461-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb461-8"><a href="04-lubridate.html#cb461-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(parameter<span class="sc">~</span>year, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb461-9"><a href="04-lubridate.html#cb461-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb461-10"><a href="04-lubridate.html#cb461-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>## Warning: Removed 1055 rows containing non-finite values (stat_smooth).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
<div id="工作日-周末趋势pm2.5" class="section level2 hasAnchor" number="3.19">
<h2><span class="header-section-number">3.19</span> 工作日-周末趋势：PM2.5<a href="04-lubridate.html#工作日-周末趋势pm2.5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="04-lubridate.html#cb464-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb464-2"><a href="04-lubridate.html#cb464-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">wday</span>(time_ymdh, <span class="at">week_start =</span> <span class="dv">1</span>),</span>
<span id="cb464-3"><a href="04-lubridate.html#cb464-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month=</span><span class="fu">month</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb464-4"><a href="04-lubridate.html#cb464-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(weekday) <span class="sc">%&gt;%</span> </span>
<span id="cb464-5"><a href="04-lubridate.html#cb464-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(PM2<span class="fl">.5</span>, <span class="at">na.rm=</span>T),</span>
<span id="cb464-6"><a href="04-lubridate.html#cb464-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(PM2<span class="fl">.5</span>, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb464-7"><a href="04-lubridate.html#cb464-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(weekday, mean))<span class="sc">+</span></span>
<span id="cb464-8"><a href="04-lubridate.html#cb464-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean<span class="sc">-</span>sd, <span class="at">ymax=</span>mean<span class="sc">+</span>sd), <span class="at">fill=</span><span class="st">&quot;grey70&quot;</span>)<span class="sc">+</span> <span class="co">#条带上下限分别是mean+-sd</span></span>
<span id="cb464-9"><a href="04-lubridate.html#cb464-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb464-10"><a href="04-lubridate.html#cb464-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb464-11"><a href="04-lubridate.html#cb464-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<p>周末和工作日PM2.5没有明显区别，周五PM2.5可能略低</p>
</div>
<div id="昼夜趋势臭氧" class="section level2 hasAnchor" number="3.20">
<h2><span class="header-section-number">3.20</span> 昼夜趋势：臭氧<a href="04-lubridate.html#昼夜趋势臭氧" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="04-lubridate.html#cb465-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb465-2"><a href="04-lubridate.html#cb465-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time_ymdh, PM2<span class="fl">.5</span>, PM10, SO2, NO2, O3, CO) <span class="sc">%&gt;%</span> </span>
<span id="cb465-3"><a href="04-lubridate.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time_ymdh),</span>
<span id="cb465-4"><a href="04-lubridate.html#cb465-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_d =</span> <span class="fu">yday</span>(time_ymdh),</span>
<span id="cb465-5"><a href="04-lubridate.html#cb465-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_h =</span> <span class="fu">hour</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb465-6"><a href="04-lubridate.html#cb465-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_h, O3, <span class="at">group=</span>time_d))<span class="sc">+</span> <span class="co">#用group将每天的数据分组，每天单独画一条线</span></span>
<span id="cb465-7"><a href="04-lubridate.html#cb465-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha=</span><span class="fl">0.1</span>, <span class="at">color=</span><span class="st">&quot;red2&quot;</span>)<span class="sc">+</span></span>
<span id="cb465-8"><a href="04-lubridate.html#cb465-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)</span></code></pre></div>
<pre><code>## Warning: Removed 13 row(s) containing missing values (geom_path).</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
<div id="昼夜趋势臭氧-1" class="section level2 hasAnchor" number="3.21">
<h2><span class="header-section-number">3.21</span> 昼夜趋势：臭氧<a href="04-lubridate.html#昼夜趋势臭氧-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>臭氧浓度有明显的昼夜变化趋势，上午10点后上升，15点左右达到最高值。</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="04-lubridate.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co">#计算整体的各小时均值（不区分月份）</span></span>
<span id="cb467-2"><a href="04-lubridate.html#cb467-2" aria-hidden="true" tabindex="-1"></a>d_all <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb467-3"><a href="04-lubridate.html#cb467-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">mutate</span>(<span class="at">time_h =</span> <span class="fu">hour</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb467-4"><a href="04-lubridate.html#cb467-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(time_h) <span class="sc">%&gt;%</span> </span>
<span id="cb467-5"><a href="04-lubridate.html#cb467-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">mean=</span> <span class="fu">mean</span>(O3, <span class="at">na.rm=</span>T)) </span>
<span id="cb467-6"><a href="04-lubridate.html#cb467-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-7"><a href="04-lubridate.html#cb467-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-8"><a href="04-lubridate.html#cb467-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb467-9"><a href="04-lubridate.html#cb467-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(time_ymdh),</span>
<span id="cb467-10"><a href="04-lubridate.html#cb467-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_h =</span> <span class="fu">hour</span>(time_ymdh),</span>
<span id="cb467-11"><a href="04-lubridate.html#cb467-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_mt =</span> <span class="fu">month</span>(time_ymdh)) <span class="sc">%&gt;%</span> </span>
<span id="cb467-12"><a href="04-lubridate.html#cb467-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time_mt, time_h) <span class="sc">%&gt;%</span> <span class="co">#按月份计算各小时均值</span></span>
<span id="cb467-13"><a href="04-lubridate.html#cb467-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span> <span class="fu">mean</span>(O3, <span class="at">na.rm=</span>T)) <span class="sc">%&gt;%</span> </span>
<span id="cb467-14"><a href="04-lubridate.html#cb467-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time_h, mean))<span class="sc">+</span></span>
<span id="cb467-15"><a href="04-lubridate.html#cb467-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;red2&quot;</span>)<span class="sc">+</span> <span class="co">#红线表示各月份的小时均值</span></span>
<span id="cb467-16"><a href="04-lubridate.html#cb467-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>d_all, <span class="fu">aes</span>(time_h, mean), <span class="at">inherit.aes=</span>F, <span class="at">color=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span> <span class="co">#灰线表示总体均值</span></span>
<span id="cb467-17"><a href="04-lubridate.html#cb467-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>time_mt)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;time_mt&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
</div>
<div id="昼夜趋势臭氧-2" class="section level2 hasAnchor" number="3.22">
<h2><span class="header-section-number">3.22</span> 昼夜趋势：臭氧<a href="04-lubridate.html#昼夜趋势臭氧-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>红线：各月份均值；灰线：总体均值<br />
各月份之间存在区别：例如1月份O3浓度低，峰值出现时间晚；6-7月份O3浓度低，峰值出现时间早；9-10月份O3浓度高，峰值出现时间与总体均值类似。</p>
<table style="width:6%;">
<colgroup>
<col width="5%" />
</colgroup>
<tbody>
<tr class="odd">
<td>## 要点小结</td>
</tr>
<tr class="even">
<td>操作 |函数
——————–|———————
将字符转化为时间 |<code>ymd()</code>系列
|<code>ymd_hms()</code>系列
提取时间信息 |<code>year()</code>-年；<code>month()</code>-月；<code>day()</code>-日
|<code>hour()</code>-时；<code>minute()</code>-分；<code>second()</code>-秒
|第几天：<code>yday()</code>-年；<code>mday()</code>-月；<code>wday()</code>-星期
坐标轴时间格式设置 |<code>scale_x_date()</code>
|<code>scale_x_datetime()</code></td>
</tr>
</tbody>
</table>
</div>
<div id="拓展阅读" class="section level2 hasAnchor" number="3.23">
<h2><span class="header-section-number">3.23</span> 拓展阅读<a href="04-lubridate.html#拓展阅读" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://lubridate.tidyverse.org/" class="uri">https://lubridate.tidyverse.org/</a></p>
<p><a href="https://r4ds.had.co.nz/dates-and-times.html" class="uri">https://r4ds.had.co.nz/dates-and-times.html</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="03-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="05-map.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tan-qiao-guo/EnvDAV/edit/master/04-lubridate.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tan-qiao-guo/EnvDAV/blod/master/04-lubridate.Rmd",
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
